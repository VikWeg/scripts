(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     50451,       1330]
NotebookOptionsPosition[     49391,       1290]
NotebookOutlinePosition[     49739,       1305]
CellTagsIndexPosition[     49696,       1302]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"GetConnectivityOffset", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"c0_", ",", "c1_", ",", "c2_"}], "}"}], ",", "VoxNum_", ",", 
    "NeighborNum_", ",", "VoxIds_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", "y", ",", "z", ",", "x0", ",", "y0", ",", "z0", ",", 
      RowBox[{"i", "=", "0"}], ",", 
      RowBox[{"j", "=", "0"}], ",", 
      RowBox[{"k", "=", "0"}], ",", 
      RowBox[{"found", "=", "0"}], ",", "Offset", ",", "CurrentNeighborNum", 
      " ", ",", "SpinCount", ",", "next", ",", "vox"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"x", " ", "=", 
      RowBox[{"Mod", "[", 
       RowBox[{"VoxNum", ",", "c0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"y", " ", "=", " ", 
      RowBox[{"Mod", "[", 
       RowBox[{
        RowBox[{"Quotient", "[", 
         RowBox[{"VoxNum", ",", "c0"}], "]"}], ",", "c1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"Quotient", "[", 
       RowBox[{"VoxNum", ",", 
        RowBox[{"c0", "*", "c1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"x0", " ", "=", " ", 
      RowBox[{"x", "-", "1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"y0", " ", "=", " ", 
      RowBox[{"y", "-", "1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"z0", " ", "=", " ", 
      RowBox[{"z", "-", "1"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"CurrentNeighborNum", " ", "=", " ", "0"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Offset", "=", "0"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"k", "=", "0"}], ",", 
       RowBox[{"k", "<", "3"}], ",", 
       RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j", "=", "0"}], ",", 
          RowBox[{"j", "<", "3"}], ",", 
          RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"i", "=", "0"}], ",", 
             RowBox[{"i", "<", "3"}], ",", 
             RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"x0", "+", "i"}], ">=", "0"}], " ", "&&", " ", 
                RowBox[{
                 RowBox[{"x0", "+", "i"}], "<", "c0"}], " ", "&&", 
                RowBox[{
                 RowBox[{"y0", "+", "j"}], ">=", " ", "0"}], " ", "&&", " ", 
                RowBox[{
                 RowBox[{"y0", " ", "+", "j"}], "<", " ", "c1"}], " ", "&&", 
                " ", 
                RowBox[{
                 RowBox[{"z0", " ", "+", "k"}], ">=", " ", "0"}], " ", "&&", 
                " ", 
                RowBox[{
                 RowBox[{"z0", "+", "k"}], " ", "<", " ", "c2"}], " ", 
                "\[IndentingNewLine]", "&&", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"x0", "+", "i"}], "\[NotEqual]", "x"}], "||", 
                  RowBox[{
                   RowBox[{"y0", "+", "j"}], "\[NotEqual]", "y"}], "||", 
                  RowBox[{
                   RowBox[{"z0", "+", "k"}], "!=", "z"}]}], ")"}], 
                "\[IndentingNewLine]", "&&", 
                RowBox[{
                 RowBox[{"VoxIds", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"z0", "+", "k"}], ")"}], "*", "c0", "*", "c1"}], 
                    " ", "+", " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"y0", "+", "j"}], ")"}], "*", "c0"}], " ", "+", 
                    " ", 
                    RowBox[{"(", 
                    RowBox[{"x0", "+", "i"}], ")"}], " ", "+", "1"}], "]"}], 
                  "]"}], "\[GreaterEqual]", "0"}]}], ",", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"CurrentNeighborNum", "\[Equal]", "NeighborNum"}], 
                  " ", ",", 
                  RowBox[{
                   RowBox[{"found", "=", "1"}], ";", 
                   RowBox[{"Break", "[", "]"}]}]}], "]"}], ";", 
                "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{"vox", "=", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"z0", "+", "k"}], ")"}], "*", "c0", "*", "c1"}], 
                  " ", "+", " ", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"y0", "+", "j"}], ")"}], "*", "c0"}], " ", "+", 
                  " ", 
                  RowBox[{"(", 
                   RowBox[{"x0", "+", "i"}], ")"}]}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"next", "=", 
                 RowBox[{"vox", " ", "+", "1"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"While", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"VoxIds", "[", 
                    RowBox[{"[", 
                    RowBox[{"next", "+", "1"}], "]"}], "]"}], "<", "0"}], ",", 
                  RowBox[{
                   RowBox[{"next", "++"}], ";"}]}], "]"}], ";", 
                "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{"Offset", "+=", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"VoxIds", "[", 
                    RowBox[{"[", 
                    RowBox[{"next", "+", "1"}], "]"}], "]"}], "-", 
                   RowBox[{"VoxIds", "[", 
                    RowBox[{"[", 
                    RowBox[{"vox", "+", "1"}], "]"}], "]"}]}], ")"}]}], ";", 
                "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{"CurrentNeighborNum", "++"}], ";"}]}], 
              "\[IndentingNewLine]", " ", "]"}]}], "\[IndentingNewLine]", 
            "\t\t", "]"}], ";", "\[IndentingNewLine]", "\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"found", "\[Equal]", "1"}], ",", 
             RowBox[{"Break", "[", "]"}]}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "\t", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"found", "\[Equal]", "1"}], ",", 
          RowBox[{"Break", "[", "]"}]}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"found", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "Offset", "\[IndentingNewLine]", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"-", "1"}]}], "\[IndentingNewLine]", "]"}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6502793781263456`*^9, 3.6502793807783504`*^9}, {
   3.6502967367235303`*^9, 3.650296769621389*^9}, {3.6502968102890606`*^9, 
   3.650296827001691*^9}, 3.6502968610745516`*^9, {3.6502980625197096`*^9, 
   3.6502980814359436`*^9}, {3.6502981634430895`*^9, 
   3.6502981710111027`*^9}, {3.650298345842213*^9, 3.6502983899000916`*^9}, {
   3.6502984392277794`*^9, 3.6502984831980577`*^9}, {3.6502985224597273`*^9, 
   3.650298656084165*^9}, {3.6502987228556833`*^9, 3.6502987280036926`*^9}, {
   3.650299585807949*^9, 3.6502996134777985`*^9}, {3.650299708457567*^9, 
   3.650299858419833*^9}, {3.650299899897707*^9, 3.650299900552908*^9}, {
   3.650299934307768*^9, 3.6502999797168484`*^9}, 3.6503002419743147`*^9, {
   3.6503007205715637`*^9, 3.6503007620952377`*^9}, 3.650300806288516*^9, {
   3.6503018153346276`*^9, 3.6503018469990835`*^9}, {3.6503019065949907`*^9, 
   3.650301923754421*^9}, {3.650302463262171*^9, 3.650302510731455*^9}, {
   3.6503025790543766`*^9, 3.6503026163846426`*^9}, {3.650302672175742*^9, 
   3.650302737708659*^9}, {3.650302786864747*^9, 3.6503028116133904`*^9}, {
   3.6503028583846736`*^9, 3.650302904273156*^9}, {3.6503031247261486`*^9, 
   3.650303138084772*^9}, {3.6503037231664553`*^9, 3.650303771884742*^9}, {
   3.6503040233867884`*^9, 3.6503040236363893`*^9}, {3.65030431651511*^9, 
   3.6503043422923555`*^9}, {3.6503045056798477`*^9, 3.6503045300560913`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Snum", "[", 
   RowBox[{"{", 
    RowBox[{"c0_", ",", "c1_", ",", "c2_"}], "}"}], "]"}], ":=", 
  RowBox[{"RandomInteger", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "3"}], "}"}], ",", 
    RowBox[{"c0", "*", "c1", "*", "c2"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.650279710178421*^9, 3.650279770815133*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"VoxIds", "[", "Snum_", "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"i", "\[Equal]", "1"}], ",", "0", ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Snum", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"-", "1"}], ",", 
         RowBox[{"Total", "[", 
          RowBox[{"Snum", "[", 
           RowBox[{"[", 
            RowBox[{"1", ";;", 
             RowBox[{"i", "-", "1"}]}], "]"}], "]"}], "]"}]}], "]"}]}], "]"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "Snum", "]"}]}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.6502798303880424`*^9, 3.650279858368694*^9}, {
   3.650279925206216*^9, 3.6502799986931562`*^9}, {3.650280115771978*^9, 
   3.650280132896209*^9}, {3.650280164392867*^9, 3.6502801841089087`*^9}, {
   3.650280245455221*^9, 3.6502802732280765`*^9}, 3.6502807255299263`*^9, 
   3.650296945842902*^9, {3.6502971747863092`*^9, 3.6502972398694253`*^9}, {
   3.6502972710160804`*^9, 3.6502973581842356`*^9}, {3.65029749577868*^9, 
   3.650297497323083*^9}, {3.6502976189636993`*^9, 3.6502977123960657`*^9}, {
   3.6502977617257533`*^9, 3.6502977618505535`*^9}, {3.6502978282098713`*^9, 
   3.650297830877476*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DrawGrid", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"c0_", ",", "c1_", ",", "c2_"}], "}"}], ",", "VoxNum_", ",", 
    "snum_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "vox", "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Grid", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"vox", "=", 
            RowBox[{
             RowBox[{"k", "*", "c0", "*", "c1"}], " ", "+", " ", 
             RowBox[{"j", "*", "c0"}], " ", "+", " ", "i"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Item", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"snum", "[", 
                 RowBox[{"[", 
                  RowBox[{"vox", "+", "1"}], "]"}], "]"}], "\[Equal]", "0"}], 
               ",", "\[IndentingNewLine]", 
               SubscriptBox["vox", "\"\<\>\""], ",", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"snum", "[", 
                   RowBox[{"[", 
                    RowBox[{"vox", "+", "1"}], "]"}], "]"}], "\[Equal]", 
                  "1"}], ",", "\[IndentingNewLine]", 
                 SubscriptBox["vox", "\"\<\!\(\*
StyleBox[\"\[CenterDot]\",
FontWeight->\"Plain\"]\)\>\""], ",", "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"snum", "[", 
                    RowBox[{"[", 
                    RowBox[{"vox", "+", "1"}], "]"}], "]"}], "\[Equal]", 
                    "2"}], ",", "\[IndentingNewLine]", 
                   SubscriptBox["vox", "\"\<\!\(\*
StyleBox[\"\[CenterDot]\",
FontWeight->\"Plain\"]\)\!\(\*
StyleBox[\"\[CenterDot]\",
FontWeight->\"Plain\"]\)\>\""], ",", "\[IndentingNewLine]", 
                   SubscriptBox["vox", "\"\<\[Therefore]\>\""]}], 
                  "\[IndentingNewLine]", "]"}]}], "]"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Background", "\[Rule]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"VoxNum", "==", 
                 RowBox[{
                  RowBox[{"k", "*", "c0", "*", "c1"}], " ", "+", " ", 
                  RowBox[{"j", "*", "c0"}], " ", "+", " ", "i"}]}], ",", 
                "Red", ",", "White"}], "]"}]}]}], " ", "\[IndentingNewLine]", 
            "]"}]}], "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "0", ",", 
            RowBox[{"c1", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", 
            RowBox[{"c0", "-", "1"}]}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Frame", "\[Rule]", "All"}], ",", 
        RowBox[{"Alignment", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Center", ",", "Center"}], "}"}]}]}], "]"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "0", ",", 
        RowBox[{"c2", "-", "1"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6502803276201777`*^9, 3.65028039942391*^9}, {
  3.650280433658573*^9, 3.650280639527953*^9}, {3.6502809192494926`*^9, 
  3.650280924402502*^9}, {3.6502809598357687`*^9, 3.6502810506111493`*^9}, {
  3.650304701260456*^9, 3.6503047839852037`*^9}, {3.6503048465321145`*^9, 
  3.650304861561941*^9}, {3.6503048985968075`*^9, 3.6503049053410196`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"snum", " ", "=", " ", 
  RowBox[{"Snum", "[", 
   RowBox[{"{", 
    RowBox[{"5", ",", "5", ",", "5"}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.650280004060566*^9, 3.650280013420983*^9}, {
   3.6502802811860905`*^9, 3.650280282856694*^9}, {3.6502805797484417`*^9, 
   3.6502805827204475`*^9}, {3.6502807950994616`*^9, 3.650280799180069*^9}, {
   3.6502969831575685`*^9, 3.6502969890095787`*^9}, {3.650297851135312*^9, 
   3.650297854653319*^9}, 3.650300946202364*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "3", ",", "0", ",", "2", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0", 
   ",", "2", ",", "2", ",", "2", ",", "3", ",", "3", ",", "3", ",", "3", ",", 
   "2", ",", "2", ",", "3", ",", "0", ",", "1", ",", "1", ",", "2", ",", "2", 
   ",", "1", ",", "1", ",", "2", ",", "1", ",", "0", ",", "2", ",", "0", ",", 
   "3", ",", "3", ",", "2", ",", "3", ",", "3", ",", "1", ",", "1", ",", "2", 
   ",", "0", ",", "1", ",", "2", ",", "0", ",", "1", ",", "1", ",", "1", ",", 
   "3", ",", "0", ",", "1", ",", "0", ",", "3", ",", "0", ",", "1", ",", "3", 
   ",", "1", ",", "0", ",", "3", ",", "3", ",", "0", ",", "0", ",", "1", ",", 
   "0", ",", "2", ",", "1", ",", "1", ",", "2", ",", "0", ",", "1", ",", "2", 
   ",", "2", ",", "3", ",", "0", ",", "2", ",", "0", ",", "0", ",", "1", ",", 
   "1", ",", "0", ",", "3", ",", "3", ",", "3", ",", "0", ",", "0", ",", "2", 
   ",", "1", ",", "2", ",", "1", ",", "3", ",", "1", ",", "3", ",", "2", ",", 
   "1", ",", "2", ",", "0", ",", "1", ",", "2", ",", "2", ",", "2", ",", "2", 
   ",", "2", ",", "1", ",", "2", ",", "1", ",", "0", ",", "1", ",", "1", ",", 
   "0", ",", "1", ",", "1", ",", "0", ",", "3", ",", "0", ",", "0", ",", "3", 
   ",", "2", ",", "0", ",", "1", ",", "1", ",", "1", ",", "0", ",", "2", ",", 
   "0", ",", "0", ",", "3", ",", "1", ",", "2"}], "}"}]], "Output",
 CellChangeTimes->{3.650300946685965*^9, 3.650301497399542*^9, 
  3.6503448756292753`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"VoxIds", "[", "snum", "]"}]], "Input",
 CellChangeTimes->{{3.650300948731569*^9, 3.650300952444375*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", 
   RowBox[{"-", "1"}], ",", "3", ",", 
   RowBox[{"-", "1"}], ",", "5", ",", "6", ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", "7", ",", "9", ",", "11", ",", "13", ",", "16", 
   ",", "19", ",", "22", ",", "25", ",", "27", ",", "29", ",", 
   RowBox[{"-", "1"}], ",", "32", ",", "33", ",", "34", ",", "36", ",", "38", 
   ",", "39", ",", "40", ",", "42", ",", 
   RowBox[{"-", "1"}], ",", "43", ",", 
   RowBox[{"-", "1"}], ",", "45", ",", "48", ",", "51", ",", "53", ",", "56", 
   ",", "59", ",", "60", ",", "61", ",", 
   RowBox[{"-", "1"}], ",", "63", ",", "64", ",", 
   RowBox[{"-", "1"}], ",", "66", ",", "67", ",", "68", ",", "69", ",", 
   RowBox[{"-", "1"}], ",", "72", ",", 
   RowBox[{"-", "1"}], ",", "73", ",", 
   RowBox[{"-", "1"}], ",", "76", ",", "77", ",", "80", ",", 
   RowBox[{"-", "1"}], ",", "81", ",", "84", ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", "87", ",", 
   RowBox[{"-", "1"}], ",", "88", ",", "90", ",", "91", ",", "92", ",", 
   RowBox[{"-", "1"}], ",", "94", ",", "95", ",", "97", ",", "99", ",", 
   RowBox[{"-", "1"}], ",", "102", ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", "104", ",", "105", ",", 
   RowBox[{"-", "1"}], ",", "106", ",", "109", ",", "112", ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", "115", ",", "117", ",", "118", ",", "120", ",", 
   "121", ",", "124", ",", "125", ",", "128", ",", "130", ",", "131", ",", 
   RowBox[{"-", "1"}], ",", "133", ",", "134", ",", "136", ",", "138", ",", 
   "140", ",", "142", ",", "144", ",", "145", ",", "147", ",", 
   RowBox[{"-", "1"}], ",", "148", ",", "149", ",", 
   RowBox[{"-", "1"}], ",", "150", ",", "151", ",", 
   RowBox[{"-", "1"}], ",", "152", ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", "155", ",", "158", ",", 
   RowBox[{"-", "1"}], ",", "160", ",", "161", ",", "162", ",", 
   RowBox[{"-", "1"}], ",", "163", ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", "165", ",", "168", ",", "169"}], "}"}]], "Output",
 CellChangeTimes->{3.650300952865576*^9, 3.6503014984603434`*^9, 
  3.6503448776456785`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DrawGrid", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"5", ",", "5", ",", "5"}], "}"}], ",", "13", ",", "snum"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6502804032815175`*^9, 3.650280414005737*^9}, {
  3.6502805858882527`*^9, 3.6502805865318537`*^9}, {3.650297872642151*^9, 
  3.6502978746077538`*^9}, {3.650304790942816*^9, 3.6503047920816174`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[GridBox[{
      {
       ItemBox[
        SubscriptBox["0", "\<\"\[Therefore]\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox["1", "\<\"\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox[
         "2", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\\\
\"Plain\\\"]\\)\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\\\"\
Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox["3", "\<\"\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox[
         "4", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\\\
\"Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False]},
      {
       ItemBox[
        SubscriptBox[
         "5", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\\\
\"Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox["6", "\<\"\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox["7", "\<\"\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox[
         "8", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\\\
\"Plain\\\"]\\)\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\\\"\
Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox[
         "9", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\\\
\"Plain\\\"]\\)\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\\\"\
Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False]},
      {
       ItemBox[
        SubscriptBox[
         "10", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\
\\\"Plain\\\"]\\)\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\\\"\
Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox["11", "\<\"\[Therefore]\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox["12", "\<\"\[Therefore]\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox["13", "\<\"\[Therefore]\"\>"],
        Background->RGBColor[1, 0, 0],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox["14", "\<\"\[Therefore]\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False]},
      {
       ItemBox[
        SubscriptBox[
         "15", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\
\\\"Plain\\\"]\\)\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\\\"\
Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox[
         "16", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\
\\\"Plain\\\"]\\)\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\\\"\
Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox["17", "\<\"\[Therefore]\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox["18", "\<\"\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox[
         "19", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\
\\\"Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False]},
      {
       ItemBox[
        SubscriptBox[
         "20", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\
\\\"Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox[
         "21", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\
\\\"Plain\\\"]\\)\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\\\"\
Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox[
         "22", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\
\\\"Plain\\\"]\\)\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\\\"\
Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox[
         "23", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\
\\\"Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox[
         "24", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\
\\\"Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False]}
     },
     AutoDelete->False,
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Center}}},
     GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
    "Grid"], ",", 
   TagBox[GridBox[{
      {
       ItemBox[
        SubscriptBox[
         "25", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\
\\\"Plain\\\"]\\)\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\\\"\
Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox[
         "26", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\
\\\"Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox["27", "\<\"\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox[
         "28", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\
\\\"Plain\\\"]\\)\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\\\"\
Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox["29", "\<\"\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False]},
      {
       ItemBox[
        SubscriptBox["30", "\<\"\[Therefore]\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox["31", "\<\"\[Therefore]\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox[
         "32", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\
\\\"Plain\\\"]\\)\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\\\"\
Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox["33", "\<\"\[Therefore]\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox["34", "\<\"\[Therefore]\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False]},
      {
       ItemBox[
        SubscriptBox[
         "35", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\
\\\"Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox[
         "36", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\
\\\"Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox[
         "37", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\
\\\"Plain\\\"]\\)\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\\\"\
Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox["38", "\<\"\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox[
         "39", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\
\\\"Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False]},
      {
       ItemBox[
        SubscriptBox[
         "40", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\
\\\"Plain\\\"]\\)\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\\\"\
Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox["41", "\<\"\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox[
         "42", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\
\\\"Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox[
         "43", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\
\\\"Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox[
         "44", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\
\\\"Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False]},
      {
       ItemBox[
        SubscriptBox["45", "\<\"\[Therefore]\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox["46", "\<\"\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox[
         "47", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\
\\\"Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox["48", "\<\"\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox["49", "\<\"\[Therefore]\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False]}
     },
     AutoDelete->False,
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Center}}},
     GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
    "Grid"], ",", 
   TagBox[GridBox[{
      {
       ItemBox[
        SubscriptBox["50", "\<\"\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox[
         "51", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\
\\\"Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox["52", "\<\"\[Therefore]\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox[
         "53", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\
\\\"Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox["54", "\<\"\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False]},
      {
       ItemBox[
        SubscriptBox["55", "\<\"\[Therefore]\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox["56", "\<\"\[Therefore]\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox["57", "\<\"\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox["58", "\<\"\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox[
         "59", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\
\\\"Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False]},
      {
       ItemBox[
        SubscriptBox["60", "\<\"\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox[
         "61", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\
\\\"Plain\\\"]\\)\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\\\"\
Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox[
         "62", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\
\\\"Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox[
         "63", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\
\\\"Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox[
         "64", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\
\\\"Plain\\\"]\\)\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\\\"\
Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False]},
      {
       ItemBox[
        SubscriptBox["65", "\<\"\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox[
         "66", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\
\\\"Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox[
         "67", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\
\\\"Plain\\\"]\\)\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\\\"\
Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox[
         "68", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\
\\\"Plain\\\"]\\)\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\\\"\
Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox["69", "\<\"\[Therefore]\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False]},
      {
       ItemBox[
        SubscriptBox["70", "\<\"\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox[
         "71", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\
\\\"Plain\\\"]\\)\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\\\"\
Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox["72", "\<\"\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox["73", "\<\"\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox[
         "74", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\
\\\"Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False]}
     },
     AutoDelete->False,
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Center}}},
     GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
    "Grid"], ",", 
   TagBox[GridBox[{
      {
       ItemBox[
        SubscriptBox[
         "75", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\
\\\"Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox["76", "\<\"\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox["77", "\<\"\[Therefore]\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox["78", "\<\"\[Therefore]\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox["79", "\<\"\[Therefore]\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False]},
      {
       ItemBox[
        SubscriptBox["80", "\<\"\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox["81", "\<\"\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox[
         "82", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\
\\\"Plain\\\"]\\)\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\\\"\
Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox[
         "83", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\
\\\"Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox[
         "84", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\
\\\"Plain\\\"]\\)\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\\\"\
Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False]},
      {
       ItemBox[
        SubscriptBox[
         "85", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\
\\\"Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox["86", "\<\"\[Therefore]\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox[
         "87", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\
\\\"Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox["88", "\<\"\[Therefore]\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox[
         "89", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\
\\\"Plain\\\"]\\)\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\\\"\
Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False]},
      {
       ItemBox[
        SubscriptBox[
         "90", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\
\\\"Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox[
         "91", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\
\\\"Plain\\\"]\\)\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\\\"\
Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox["92", "\<\"\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox[
         "93", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\
\\\"Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox[
         "94", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\
\\\"Plain\\\"]\\)\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\\\"\
Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False]},
      {
       ItemBox[
        SubscriptBox[
         "95", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\
\\\"Plain\\\"]\\)\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\\\"\
Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox[
         "96", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\
\\\"Plain\\\"]\\)\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\\\"\
Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox[
         "97", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\
\\\"Plain\\\"]\\)\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\\\"\
Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox[
         "98", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\
\\\"Plain\\\"]\\)\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\\\"\
Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox[
         "99", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\
\\\"Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False]}
     },
     AutoDelete->False,
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Center}}},
     GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
    "Grid"], ",", 
   TagBox[GridBox[{
      {
       ItemBox[
        SubscriptBox[
         "100", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\
\\\"Plain\\\"]\\)\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\\\"\
Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox[
         "101", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\
\\\"Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox["102", "\<\"\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox[
         "103", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\
\\\"Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox[
         "104", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\
\\\"Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False]},
      {
       ItemBox[
        SubscriptBox["105", "\<\"\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox[
         "106", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\
\\\"Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox[
         "107", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\
\\\"Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox["108", "\<\"\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox["109", "\<\"\[Therefore]\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False]},
      {
       ItemBox[
        SubscriptBox["110", "\<\"\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox["111", "\<\"\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox["112", "\<\"\[Therefore]\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox[
         "113", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\
\\\"Plain\\\"]\\)\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\\\"\
Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox["114", "\<\"\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False]},
      {
       ItemBox[
        SubscriptBox[
         "115", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\
\\\"Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox[
         "116", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\
\\\"Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox[
         "117", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\
\\\"Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox["118", "\<\"\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox[
         "119", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\
\\\"Plain\\\"]\\)\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\\\"\
Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False]},
      {
       ItemBox[
        SubscriptBox["120", "\<\"\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox["121", "\<\"\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox["122", "\<\"\[Therefore]\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox[
         "123", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\
\\\"Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False], 
       ItemBox[
        SubscriptBox[
         "124", "\<\"\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\
\\\"Plain\\\"]\\)\\!\\(\\*\\nStyleBox[\\\"\[CenterDot]\\\",\\nFontWeight->\\\"\
Plain\\\"]\\)\"\>"],
        Background->GrayLevel[1],
        StripOnInput->False]}
     },
     AutoDelete->False,
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Center}}},
     GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
    "Grid"]}], "}"}]], "Output",
 CellChangeTimes->{{3.650280414475738*^9, 3.6502804486456003`*^9}, 
   3.650280500591096*^9, {3.6502806135835047`*^9, 3.6502806622921953`*^9}, 
   3.650280733971942*^9, 3.6502810196020923`*^9, 3.6502810532943535`*^9, 
   3.650297839977292*^9, 3.650297877618559*^9, 3.6503002693739634`*^9, 
   3.650301499662546*^9, 3.6503047968758264`*^9, 3.650304865196748*^9, 
   3.6503049092878265`*^9, 3.650344878690881*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"GetConnectivityOffset", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "5", ",", "5"}], "}"}], ",", "13", ",", "i", ",", 
     RowBox[{"VoxIds", "[", "snum", "]"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "0", ",", "25"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6503000675644045`*^9, 3.6503001310231175`*^9}, {
   3.6503019869887333`*^9, 3.650301987175934*^9}, 3.6503032567201834`*^9, 
   3.650303788755372*^9, 3.6503038968205633`*^9, 3.6503039317630253`*^9, 
   3.6503045805129814`*^9, 3.650304613431841*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "3", ",", "4", ",", "5", ",", "8", ",", "10", ",", "11", ",", 
   "12", ",", "15", ",", "18", ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.650300108567678*^9, 3.650300131740719*^9}, 
   3.650300253739735*^9, 3.6503015040315533`*^9, 3.6503018628215117`*^9, 
   3.6503019282316294`*^9, 3.650301987893535*^9, {3.650302881812316*^9, 
   3.6503028841689196`*^9}, 3.65030314822779*^9, 3.6503032570789833`*^9, {
   3.6503037791905546`*^9, 3.650303789472973*^9}, 3.6503038973509645`*^9, 
   3.6503039322778263`*^9, 3.650304027944997*^9, 3.650304536125502*^9, 
   3.650304581386583*^9, 3.650304614539443*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"GetNonEmptyNeighborVoxsCount", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"5", ",", "5", ",", "5"}], "}"}], ",", "i", ",", 
      RowBox[{"VoxIds", "[", "snum", "]"}]}], "]"}], "-", "26", "+", 
    RowBox[{"Count", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"GetConnectivityOffset", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"5", ",", "5", ",", "5"}], "}"}], ",", "i", ",", "j", ",", 
          RowBox[{"VoxIds", "[", "snum", "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "0", ",", "25"}], "}"}]}], "]"}], ",", 
      RowBox[{"-", "1"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"i", ",", "0", ",", "74"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6503051537666626`*^9, 3.650305210474163*^9}, {
  3.650305265840061*^9, 3.650305336078786*^9}, {3.6503054413485727`*^9, 
  3.650305457503601*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.650305170243292*^9, 3.650305337966389*^9, 
  3.6503054610136075`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"GetNeighborSpinCount", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"5", ",", "5", ",", "5"}], "}"}], ",", "49", ",", 
   RowBox[{"VoxIds", "[", "snum", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.650344893986309*^9, 3.650344965507641*^9}}],

Cell[BoxData["11"], "Output",
 CellChangeTimes->{{3.6503449116741405`*^9, 3.6503449659288416`*^9}}]
}, Open  ]]
},
WindowSize->{1655, 1228},
WindowMargins->{{411, Automatic}, {57, Automatic}},
FrontEndVersion->"10.0 for Microsoft Windows (64-bit) (December 4, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 8614, 186, 912, "Input"],
Cell[9175, 208, 365, 10, 31, "Input"],
Cell[9543, 220, 1435, 33, 72, "Input"],
Cell[10981, 255, 3760, 87, 452, "Input"],
Cell[CellGroupData[{
Cell[14766, 346, 498, 9, 31, "Input"],
Cell[15267, 357, 1461, 21, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16765, 383, 128, 2, 31, "Input"],
Cell[16896, 387, 2168, 42, 72, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19101, 434, 380, 8, 31, "Input"],
Cell[19484, 444, 25722, 735, 100, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45243, 1184, 608, 13, 31, "Input"],
Cell[45854, 1199, 1112, 27, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47003, 1231, 1025, 25, 72, "Input"],
Cell[48031, 1258, 936, 15, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49004, 1278, 269, 6, 31, "Input"],
Cell[49276, 1286, 99, 1, 31, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
