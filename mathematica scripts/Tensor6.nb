(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    123957,       2667]
NotebookOptionsPosition[    121720,       2590]
NotebookOutlinePosition[    122067,       2605]
CellTagsIndexPosition[    122024,       2602]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"TensorData", " ", "=", " ", 
   RowBox[{"ToExpression", "[", 
    RowBox[{
    "Import", "[", 
     "\"\<C:\\\\ETH\\\\Neuro\\\\GlobalTracking\\\\GlobalTrackingScripts\\\\\
tensor_data.txt\>\"", "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{"dim", "=", 
  RowBox[{"Dimensions", "[", "TensorData", "]"}]}], "\n", 
 RowBox[{
  RowBox[{"Tensor", "[", 
   RowBox[{"i_", ",", "j_", ",", "k_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"TensorData", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j", ",", "k", ",", "1"}], "]"}], "]"}], ",", 
      RowBox[{"TensorData", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j", ",", "k", ",", "2"}], "]"}], "]"}], ",", 
      RowBox[{"TensorData", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j", ",", "k", ",", "3"}], "]"}], "]"}]}], "}"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"TensorData", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j", ",", "k", ",", "2"}], "]"}], "]"}], ",", 
      RowBox[{"TensorData", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j", ",", "k", ",", "4"}], "]"}], "]"}], ",", 
      RowBox[{"TensorData", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j", ",", "k", ",", "5"}], "]"}], "]"}]}], "}"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"TensorData", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j", ",", "k", ",", "3"}], "]"}], "]"}], ",", 
      RowBox[{"TensorData", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j", ",", "k", ",", "5"}], "]"}], "]"}], ",", 
      RowBox[{"TensorData", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j", ",", "k", ",", "6"}], "]"}], "]"}]}], "}"}]}], 
   "}"}]}]}], "Input",
 CellChangeTimes->{{3.6376408711401596`*^9, 3.63764090944243*^9}, {
  3.637642223442727*^9, 3.637642224035528*^9}, {3.637642588013631*^9, 
  3.6376425897452335`*^9}, {3.6376427209040656`*^9, 3.6376427701155524`*^9}, {
  3.6376428653375206`*^9, 3.637642901132984*^9}, {3.6376430845609083`*^9, 
  3.6376431307283897`*^9}, {3.6376431863066874`*^9, 3.6376431866342883`*^9}, {
  3.6376436659501348`*^9, 3.637643671285344*^9}, {3.638016044529835*^9, 
  3.6380160579776044`*^9}, {3.638022352874652*^9, 3.638022357140896*^9}, {
  3.638026101989089*^9, 3.6380261058433094`*^9}, {3.6380295187905188`*^9, 
  3.638029591439674*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"9", ",", "9", ",", "9", ",", "6"}], "}"}]], "Output",
 CellChangeTimes->{
  3.6386947448877144`*^9, 3.6387265492276173`*^9, 3.6387691619472556`*^9, 
   3.638778407116049*^9, 3.6387840076943836`*^9, 3.638846436643702*^9, 
   3.6388481010602264`*^9, 3.638848734984867*^9, 3.638869857688972*^9, 
   3.6388705145905256`*^9, 3.638870866995145*^9, 3.639234454604957*^9, 
   3.6392440159317846`*^9, 3.6392826506447225`*^9, 3.6392857231432467`*^9, 
   3.639292521978692*^9, 3.639300656656495*^9, 3.639303123335764*^9, 
   3.6395721901988707`*^9, 3.6396274410391636`*^9, 3.6398431781115456`*^9, {
   3.6406880575646796`*^9, 3.6406880729619064`*^9}}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"g", "[", 
   RowBox[{"{", 
    RowBox[{"\[Phi]_", ",", "\[Theta]_"}], "}"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"Sin", "[", "\[Theta]", "]"}], 
     RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", 
    RowBox[{
     RowBox[{"Sin", "[", "\[Theta]", "]"}], 
     RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
    RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"angle", "[", "vec_", "]"}], ":=", 
   RowBox[{"{", "   ", 
    RowBox[{
     RowBox[{
      RowBox[{"Sign", "[", 
       RowBox[{"vec", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "]"}], 
      RowBox[{"ArcCos", "[", 
       RowBox[{
        RowBox[{"vec", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "/", 
        RowBox[{"Norm", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"vec", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"vec", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}]}], "]"}]}], "   ", 
     ",", "   ", 
     RowBox[{"ArcCos", "[", 
      RowBox[{"vec", "[", 
       RowBox[{"[", "3", "]"}], "]"}], " ", "]"}]}], "   ", "}"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SurfacePositions", " ", "=", " ", 
   RowBox[{"Select", "[", " ", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "j", ",", "k"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}], ",", "2"}], 
      "]"}], ",", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "1"}], " ", "||", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
         RowBox[{"dim", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], " ", "||", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "1"}], " ", "||", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
         RowBox[{"dim", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "||", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "1"}], " ", "||", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", 
         RowBox[{"dim", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}]}], " ", ")"}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6386943815318766`*^9, 3.638694384823482*^9}, {
   3.638694699460435*^9, 3.6386947214564734`*^9}, {3.63869593761535*^9, 
   3.6386959382705507`*^9}, {3.6386973477174263`*^9, 3.638697360369049*^9}, {
   3.6386974006327195`*^9, 3.638697429055969*^9}, {3.6386979707045207`*^9, 
   3.638698103866355*^9}, {3.638698520131132*^9, 3.6386985511283865`*^9}, {
   3.6386986665061893`*^9, 3.638698698689046*^9}, {3.638698764957962*^9, 
   3.6386988005728245`*^9}, {3.638698839713293*^9, 3.638698853378917*^9}, {
   3.638698916886629*^9, 3.6386989553718967`*^9}, {3.6386989886467547`*^9, 
   3.6386990122651963`*^9}, {3.6386990584568777`*^9, 
   3.6386990676452937`*^9}, {3.6386991025113544`*^9, 3.638699118236182*^9}, {
   3.6386994714520025`*^9, 3.638699473636007*^9}, {3.638699526332899*^9, 
   3.638699537050118*^9}, {3.638702989286158*^9, 3.6387029900817595`*^9}, {
   3.638703041156249*^9, 3.638703117299983*^9}, {3.638703171322878*^9, 
   3.6387032204785643`*^9}, {3.6387748667675524`*^9, 
   3.6387748747750106`*^9}, {3.6387758340718794`*^9, 
   3.6387758506268263`*^9}, {3.6387759516396036`*^9, 3.638775960646119*^9}, {
   3.6387767170123806`*^9, 3.6387767235867567`*^9}, {3.6387772703620305`*^9, 
   3.6387772900861588`*^9}, {3.6387784179636693`*^9, 
   3.6387784220589037`*^9}, {3.6387820323704014`*^9, 
   3.6387820756848793`*^9}, {3.6388469570258164`*^9, 
   3.6388469985062895`*^9}, {3.6388503888643208`*^9, 
   3.6388504569404435`*^9}, {3.638850809329885*^9, 3.6388509549823446`*^9}, {
   3.638869908248661*^9, 3.6388699114466667`*^9}, {3.638871094849145*^9, 
   3.638871111946775*^9}, {3.638871164175667*^9, 3.6388711725684814`*^9}, {
   3.639236943553269*^9, 3.639236970147716*^9}, {3.639286435550498*^9, 
   3.6392864361588993`*^9}, 3.6392936332622433`*^9, {3.639300281210635*^9, 
   3.6393003142982936`*^9}}],

Cell[CellGroupData[{

Cell["Initialization", "Subsection",
 CellChangeTimes->{{3.6392936406098566`*^9, 3.6392936450558643`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Initialize", "[", 
   RowBox[{"E0init_", ",", "\[Alpha]maxinit_"}], "]"}], ":=", 
  RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Alpha]max", " ", "=", " ", "\[Alpha]maxinit"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"E0", " ", "=", "E0init"}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"Surface", " ", "=", " ", 
     RowBox[{"Select", "[", " ", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", "j", ",", "k", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"dim", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"dim", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", 
             RowBox[{"dim", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}], ",", "2"}], 
        "]"}], ",", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "1"}], " ", "||", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], " ", "||", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "1"}], " ", "||", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "||", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "1"}], " ", "||", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}]}], " ", ")"}], "&"}]}], "]"}]}], 
    ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"S", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Eigenvectors", "[", 
         RowBox[{"Tensor", "[", 
          RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"dim", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"dim", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"dim", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"S", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"g", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"2", "Pi"}]}], "}"}], "]"}], ",", 
            RowBox[{"RandomReal", "[", 
             RowBox[{"{", 
              RowBox[{"0", ",", "Pi"}], "}"}], "]"}]}], "}"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}]}], ";"}], "*)"}],
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"A", "=", 
     RowBox[{"Association", "[", "\[IndentingNewLine]", 
      RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", "j", ",", "k", ",", "1"}], "}"}], "\[Rule]", 
           RowBox[{"Association", "[", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"\"\<tensor\>\"", "->", 
               RowBox[{"Tensor", "[", 
                RowBox[{"i", ",", "j", ",", "k"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<direction\>\"", "->", 
               RowBox[{"S", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<position\>\"", " ", "\[Rule]", " ", 
               RowBox[{"{", 
                RowBox[{"i", ",", "j", ",", "k"}], "}"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<neighbors\>\"", "\[Rule]", " ", 
               RowBox[{"DeleteCases", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"ii", ",", "jj", ",", "kk", ",", "1"}], "}"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"ii", ",", 
                    RowBox[{"Max", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"i", "-", "1"}]}], "]"}], ",", 
                    RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"dim", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"i", "+", "1"}]}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"jj", ",", 
                    RowBox[{"Max", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"j", "-", "1"}]}], "]"}], ",", 
                    RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"dim", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"j", "+", "1"}]}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"kk", ",", 
                    RowBox[{"Max", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"k", "-", "1"}]}], "]"}], ",", 
                    RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"dim", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"k", "+", "1"}]}], "]"}]}], "}"}]}], "]"}], ",", 
                   "\[IndentingNewLine]", "2"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "j", ",", "k", ",", "1"}], "}"}]}], 
                "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"\"\<forward\>\"", "->", 
               RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"\"\<backward\>\"", "->", 
               RowBox[{"{", "}"}]}]}], "}"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"dim", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", 
            RowBox[{"dim", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", 
            RowBox[{"dim", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}], ",", "3"}], 
       "]"}], "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"A", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "}"}], "\[Rule]", 
       RowBox[{"Association", "[", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\"\<tensor\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<direction\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<position\>\"", " ", "\[Rule]", " ", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<neighbors\>\"", "\[Rule]", " ", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<forward\>\"", "->", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<backward\>\"", "->", 
           RowBox[{"{", "}"}]}]}], "}"}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}], ";"}], "\[IndentingNewLine]", "}"}]}]], "Input",
 CellChangeTimes->{{3.6386943815318766`*^9, 3.638694384823482*^9}, {
   3.638694699460435*^9, 3.6386947214564734`*^9}, {3.63869593761535*^9, 
   3.6386959382705507`*^9}, {3.6386973477174263`*^9, 3.638697360369049*^9}, {
   3.6386974006327195`*^9, 3.638697429055969*^9}, {3.6386979707045207`*^9, 
   3.638698103866355*^9}, {3.638698520131132*^9, 3.6386985511283865`*^9}, {
   3.6386986665061893`*^9, 3.638698698689046*^9}, {3.638698764957962*^9, 
   3.6386988005728245`*^9}, {3.638698839713293*^9, 3.638698853378917*^9}, {
   3.638698916886629*^9, 3.6386989553718967`*^9}, {3.6386989886467547`*^9, 
   3.6386990122651963`*^9}, {3.6386990584568777`*^9, 
   3.6386990676452937`*^9}, {3.6386991025113544`*^9, 3.638699118236182*^9}, {
   3.6386994714520025`*^9, 3.638699473636007*^9}, {3.638699526332899*^9, 
   3.638699537050118*^9}, {3.638702989286158*^9, 3.6387029900817595`*^9}, {
   3.638703041156249*^9, 3.638703117299983*^9}, {3.638703171322878*^9, 
   3.6387032204785643`*^9}, {3.6387748667675524`*^9, 
   3.6387748747750106`*^9}, {3.6387758340718794`*^9, 
   3.6387758506268263`*^9}, {3.6387759516396036`*^9, 3.638775960646119*^9}, {
   3.6387767170123806`*^9, 3.6387767235867567`*^9}, {3.6387772703620305`*^9, 
   3.6387772900861588`*^9}, {3.6387784179636693`*^9, 
   3.6387784220589037`*^9}, {3.6387820323704014`*^9, 
   3.6387820756848793`*^9}, {3.6388469570258164`*^9, 
   3.6388469985062895`*^9}, {3.6388503888643208`*^9, 
   3.6388504569404435`*^9}, {3.638850809329885*^9, 3.6388509549823446`*^9}, {
   3.638869908248661*^9, 3.6388699114466667`*^9}, {3.638871094849145*^9, 
   3.638871111946775*^9}, {3.638871164175667*^9, 3.6388711725684814`*^9}, {
   3.639236943553269*^9, 3.639236970147716*^9}, {3.639286435550498*^9, 
   3.6392864361588993`*^9}, 3.6392936332622433`*^9, {3.6393002972786636`*^9, 
   3.6393002976218643`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Neighborhood Functions", "Subsection",
 CellChangeTimes->{{3.6392936149010115`*^9, 3.639293620953822*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"F", "[", "spin_", "]"}], ":=", 
   RowBox[{"Select", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"A", "[", "spin", "]"}], "[", "\"\<neighbors\>\"", "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"A", "[", "#", "]"}], "[", "\"\<position\>\"", "]"}], 
            "-", 
            RowBox[{
             RowBox[{"A", "[", "spin", "]"}], "[", "\"\<position\>\"", 
             "]"}]}], ")"}], ".", 
          RowBox[{
           RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"", "]"}]}],
          ">", "0"}], "  ", "&&", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"A", "[", "#", "]"}], "[", "\"\<forward\>\"", "]"}], 
           "\[Equal]", 
           RowBox[{"{", "}"}]}], "||", 
          RowBox[{
           RowBox[{
            RowBox[{"A", "[", "#", "]"}], "[", "\"\<backward\>\"", "]"}], 
           "\[Equal]", 
           RowBox[{"{", "}"}]}]}], ")"}]}], " ", ")"}], "&"}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B", "[", "spin_", "]"}], ":=", 
  RowBox[{"Select", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"A", "[", "spin", "]"}], "[", "\"\<neighbors\>\"", "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"A", "[", "#", "]"}], "[", "\"\<position\>\"", "]"}], "-", 
           RowBox[{
            RowBox[{"A", "[", "spin", "]"}], "[", "\"\<position\>\"", "]"}]}],
           ")"}], ".", 
         RowBox[{
          RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"", "]"}]}], 
        "<=", "0"}], "  ", "&&", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"A", "[", "#", "]"}], "[", "\"\<forward\>\"", "]"}], 
          "\[Equal]", 
          RowBox[{"{", "}"}]}], "||", 
         RowBox[{
          RowBox[{
           RowBox[{"A", "[", "#", "]"}], "[", "\"\<backward\>\"", "]"}], 
          "\[Equal]", 
          RowBox[{"{", "}"}]}]}], ")"}]}], " ", ")"}], "&"}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.638694770144159*^9, 3.638694842965087*^9, 3.63869497554972*^9, {
   3.6386951196939726`*^9, 3.63869520912893*^9}, {3.638695240391385*^9, 
   3.6386952434957905`*^9}, {3.6386956229783974`*^9, 3.638695635037218*^9}, {
   3.6386957889782887`*^9, 3.638695791770694*^9}, {3.6386958235791492`*^9, 
   3.6386958263091545`*^9}, {3.6386958863224597`*^9, 3.6386959089736996`*^9}, 
   3.6386959619669924`*^9, {3.6386959945554495`*^9, 3.638696008267874*^9}, {
   3.6386960670643773`*^9, 3.6386961369525003`*^9}, {3.63869617117896*^9, 
   3.638696175500168*^9}, {3.6386962092430267`*^9, 3.638696341297259*^9}, {
   3.638698588053651*^9, 3.6386985911736565`*^9}, {3.638699188592306*^9, 
   3.6386991912599106`*^9}, {3.638699239869596*^9, 3.63869931027252*^9}, {
   3.638699381861046*^9, 3.638699400159878*^9}, {3.638699445275157*^9, 
   3.6386994503451657`*^9}, 3.6386994807496195`*^9, {3.6386995535393467`*^9, 
   3.638699570699377*^9}, {3.638699794769848*^9, 3.6386998261415033`*^9}, {
   3.6387000477242923`*^9, 3.638700055602306*^9}, {3.638700123337625*^9, 
   3.638700152431676*^9}, {3.6387002376234255`*^9, 3.6387003937953*^9}, {
   3.6387005477519703`*^9, 3.638700589544444*^9}, {3.6387006211500998`*^9, 
   3.6387007794903774`*^9}, {3.638700824200056*^9, 3.6387010459388456`*^9}, 
   3.638701090851324*^9, {3.638701499795542*^9, 3.638701511121162*^9}, {
   3.6387694080083294`*^9, 3.6387695014086714`*^9}, {3.638774391557372*^9, 
   3.638774418332904*^9}, {3.6387744651485815`*^9, 3.638774516594524*^9}, {
   3.638847264829957*^9, 3.6388472946572094`*^9}, {3.6388473376976852`*^9, 
   3.6388473390860877`*^9}, {3.638847392968582*^9, 3.638847452342286*^9}, {
   3.638870798620225*^9, 3.638870806825839*^9}, {3.639247333130267*^9, 
   3.6392473345473237`*^9}, {3.639282776146943*^9, 3.6392828071285973`*^9}, {
   3.6392828387030525`*^9, 3.639282845629465*^9}, {3.6392828859087358`*^9, 
   3.6392828900895433`*^9}, {3.639285930499611*^9, 3.6392860660170493`*^9}, {
   3.6392863863012114`*^9, 3.6392864037264423`*^9}, {3.639286447219319*^9, 
   3.6392864853769855`*^9}, {3.639286951583804*^9, 3.639286957496215*^9}, {
   3.6392869955446815`*^9, 3.639287007946704*^9}, 3.639293590065768*^9, {
   3.6398443286998634`*^9, 3.639844339209879*^9}, {3.6398444385530224`*^9, 
   3.6398445005721197`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Flip Fiber", "Subsection",
 CellChangeTimes->{{3.6398445795662346`*^9, 3.6398445822762384`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Flip", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "dir_"}], "]"}], ":=", " ", "Null"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Flip", "[", 
   RowBox[{"spin_", ",", "dir_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"forward", ",", "backward"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"forward", " ", "=", " ", 
      RowBox[{
       RowBox[{"A", "[", "spin", "]"}], "[", "\"\<forward\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"backward", " ", "=", " ", 
      RowBox[{
       RowBox[{"A", "[", "spin", "]"}], "[", "\"\<backward\>\"", "]"}]}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"dir", " ", "==", " ", "\"\<forwards\>\""}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"", "]"}], 
         " ", "*=", " ", 
         RowBox[{"-", "1."}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", "spin", "]"}], "[", "\"\<backward\>\"", "]"}], 
         " ", "=", "  ", "forward"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", "spin", "]"}], "[", "\"\<forward\>\"", "]"}], " ",
          "=", " ", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Flip", "[", 
         RowBox[{"forward", ",", "\"\<forwards\>\""}], "]"}]}], 
       "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"", "]"}], 
         " ", "*=", " ", 
         RowBox[{"-", "1."}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", "spin", "]"}], "[", "\"\<forward\>\"", "]"}], " ",
          "=", "  ", "backward"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", "spin", "]"}], "[", "\"\<backward\>\"", "]"}], 
         " ", "=", " ", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Flip", "[", 
         RowBox[{"backward", ",", " ", "\"\<backwards\>\""}], "]"}]}]}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.639844586056244*^9, 3.639844648651334*^9}, 
   3.639844755664709*^9, {3.6398452962920184`*^9, 3.639845492115301*^9}, {
   3.6398455758334312`*^9, 3.6398457245966454`*^9}, {3.6399304877523537`*^9, 
   3.6399305023933754`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Energy Functions", "Subsection",
 CellChangeTimes->{{3.6392936023897896`*^9, 3.6392936060245957`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Eint", "[", 
    RowBox[{"{", "}"}], "]"}], ":=", "0"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Eint", "[", "spin_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"COS\[Alpha]", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ",", "backward", ",", "forward", ",", 
       "connection"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"forward", " ", "=", " ", 
       RowBox[{
        RowBox[{"A", "[", "spin", "]"}], "[", "\"\<forward\>\"", "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"backward", " ", "=", " ", 
       RowBox[{
        RowBox[{"A", "[", "spin", "]"}], "[", "\"\<backward\>\"", "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"backward", "\[NotEqual]", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"connection", " ", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"A", "[", "backward", "]"}], "[", "\"\<position\>\"", 
            "]"}], "-", 
           RowBox[{
            RowBox[{"A", "[", "spin", "]"}], "[", "\"\<position\>\"", 
            "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"COS\[Alpha]", ",", 
           RowBox[{"Abs", "[", 
            RowBox[{
             RowBox[{"connection", ".", 
              RowBox[{
               RowBox[{"A", "[", "backward", "]"}], "[", "\"\<direction\>\"", 
               "]"}]}], "/", 
             RowBox[{"Norm", "[", "connection", "]"}]}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"COS\[Alpha]", ",", 
           RowBox[{"Abs", "[", 
            RowBox[{
             RowBox[{"connection", ".", 
              RowBox[{
               RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"", 
               "]"}]}], "/", 
             RowBox[{"Norm", "[", "connection", "]"}]}], "]"}]}], "]"}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"forward", "\[NotEqual]", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"connection", " ", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"A", "[", "forward", "]"}], "[", "\"\<position\>\"", 
            "]"}], "-", 
           RowBox[{
            RowBox[{"A", "[", "spin", "]"}], "[", "\"\<position\>\"", 
            "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"COS\[Alpha]", ",", " ", 
           RowBox[{"Abs", "[", 
            RowBox[{
             RowBox[{"connection", ".", 
              RowBox[{
               RowBox[{"A", "[", "forward", "]"}], "[", "\"\<direction\>\"", 
               "]"}]}], " ", "/", 
             RowBox[{"Norm", "[", "connection", "]"}]}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"COS\[Alpha]", ",", " ", 
           RowBox[{"Abs", "[", 
            RowBox[{
             RowBox[{"connection", ".", 
              RowBox[{
               RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"", 
               "]"}]}], "/", 
             RowBox[{"Norm", "[", "connection", "]"}]}], " ", "]"}]}], "]"}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", " ", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{"cos\[Alpha]", "-", 
             RowBox[{"Cos", "[", "\[Alpha]max", "]"}]}], 
            RowBox[{"1", "-", 
             RowBox[{"Cos", "[", "\[Alpha]max", "]"}]}]], ">", "0"}], ",", 
          RowBox[{"-", 
           RowBox[{"Log", "[", 
            FractionBox[
             RowBox[{"cos\[Alpha]", "-", 
              RowBox[{"Cos", "[", "\[Alpha]max", "]"}]}], 
             RowBox[{"1", "-", 
              RowBox[{"Cos", "[", "\[Alpha]max", "]"}]}]], "]"}]}], ",", 
          "\[Infinity]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"cos\[Alpha]", ",", "COS\[Alpha]"}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Eint", "[", 
    RowBox[{"spin1_", ",", "spin2_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"COS\[Alpha]", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ",", "backward", ",", "forward", ",", 
       "connection"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"connection", " ", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"A", "[", "spin1", "]"}], "[", "\"\<position\>\"", "]"}], 
        "-", 
        RowBox[{
         RowBox[{"A", "[", "spin2", "]"}], "[", "\"\<position\>\"", "]"}]}]}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"COS\[Alpha]", ",", 
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"connection", ".", 
           RowBox[{
            RowBox[{"A", "[", "spin1", "]"}], "[", "\"\<direction\>\"", 
            "]"}]}], "/", 
          RowBox[{"Norm", "[", "connection", "]"}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"COS\[Alpha]", ",", 
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"connection", ".", 
           RowBox[{
            RowBox[{"A", "[", "spin2", "]"}], "[", "\"\<direction\>\"", 
            "]"}]}], "/", 
          RowBox[{"Norm", "[", "connection", "]"}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      " ", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{"cos\[Alpha]", "-", 
             RowBox[{"Cos", "[", "\[Alpha]max", "]"}]}], 
            RowBox[{"1", "-", 
             RowBox[{"Cos", "[", "\[Alpha]max", "]"}]}]], ">", "0"}], ",", 
          RowBox[{"-", 
           RowBox[{"Log", "[", 
            FractionBox[
             RowBox[{"cos\[Alpha]", "-", 
              RowBox[{"Cos", "[", "\[Alpha]max", "]"}]}], 
             RowBox[{"1", "-", 
              RowBox[{"Cos", "[", "\[Alpha]max", "]"}]}]], "]"}]}], ",", 
          "\[Infinity]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"cos\[Alpha]", ",", "COS\[Alpha]"}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Edata", "[", "spin_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Tinv", ",", "norm"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Tinv", " ", "=", " ", 
       RowBox[{"Inverse", "[", 
        RowBox[{
         RowBox[{"A", "[", "spin", "]"}], "[", "\"\<tensor\>\"", "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"norm", "=", 
       RowBox[{
        FractionBox["2", 
         RowBox[{"\[Pi]", "^", "2"}]], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Tinv", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", 
          RowBox[{"Tinv", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "2"}], "]"}], "]"}], "+", 
          RowBox[{"2", "*", 
           RowBox[{"Tinv", "[", 
            RowBox[{"[", 
             RowBox[{"3", ",", "3"}], "]"}], "]"}]}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"", "]"}], 
        ".", "Tinv", ".", 
        RowBox[{
         RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"", "]"}]}], 
       "/", "norm"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.638694770144159*^9, 3.638694842965087*^9, 3.63869497554972*^9, {
   3.6386951196939726`*^9, 3.63869520912893*^9}, {3.638695240391385*^9, 
   3.6386952434957905`*^9}, {3.6386956229783974`*^9, 3.638695635037218*^9}, {
   3.6386957889782887`*^9, 3.638695791770694*^9}, {3.6386958235791492`*^9, 
   3.6386958263091545`*^9}, {3.6386958863224597`*^9, 3.6386959089736996`*^9}, 
   3.6386959619669924`*^9, {3.6386959945554495`*^9, 3.638696008267874*^9}, {
   3.6386960670643773`*^9, 3.6386961369525003`*^9}, {3.63869617117896*^9, 
   3.638696175500168*^9}, {3.6386962092430267`*^9, 3.638696341297259*^9}, {
   3.638698588053651*^9, 3.6386985911736565`*^9}, {3.638699188592306*^9, 
   3.6386991912599106`*^9}, {3.638699239869596*^9, 3.63869931027252*^9}, {
   3.638699381861046*^9, 3.638699400159878*^9}, {3.638699445275157*^9, 
   3.6386994503451657`*^9}, 3.6386994807496195`*^9, {3.6386995535393467`*^9, 
   3.638699570699377*^9}, {3.638699794769848*^9, 3.6386998261415033`*^9}, {
   3.6387000477242923`*^9, 3.638700055602306*^9}, {3.638700123337625*^9, 
   3.638700152431676*^9}, {3.6387002376234255`*^9, 3.6387003937953*^9}, {
   3.6387005477519703`*^9, 3.638700589544444*^9}, {3.6387006211500998`*^9, 
   3.6387007794903774`*^9}, {3.638700824200056*^9, 3.6387010459388456`*^9}, 
   3.638701090851324*^9, {3.638701499795542*^9, 3.638701511121162*^9}, {
   3.6387694080083294`*^9, 3.6387695014086714`*^9}, {3.638774391557372*^9, 
   3.638774418332904*^9}, {3.6387744651485815`*^9, 3.638774516594524*^9}, {
   3.638847264829957*^9, 3.6388472946572094`*^9}, {3.6388473376976852`*^9, 
   3.6388473390860877`*^9}, {3.638847392968582*^9, 3.638847452342286*^9}, {
   3.638870798620225*^9, 3.638870806825839*^9}, {3.639247333130267*^9, 
   3.6392473345473237`*^9}, {3.639282776146943*^9, 3.6392828071285973`*^9}, {
   3.6392828387030525`*^9, 3.639282845629465*^9}, {3.6392828859087358`*^9, 
   3.6392828900895433`*^9}, {3.639285930499611*^9, 3.6392860660170493`*^9}, {
   3.6392863863012114`*^9, 3.6392864037264423`*^9}, {3.639286447219319*^9, 
   3.6392864853769855`*^9}, {3.639286951583804*^9, 3.639286957496215*^9}, {
   3.6392869955446815`*^9, 3.639287007946704*^9}, 3.639293590065768*^9, {
   3.63929410027643*^9, 3.639294147497713*^9}, {3.6392945813968754`*^9, 
   3.6392946417221813`*^9}, {3.639296628969*^9, 3.639296632198206*^9}, {
   3.6393001043219247`*^9, 3.639300134679578*^9}, {3.63963101986337*^9, 
   3.6396310289737864`*^9}, {3.639634116825578*^9, 3.639634309236316*^9}, 
   3.6396344003872766`*^9, 3.639843287514705*^9, {3.639931351329856*^9, 
   3.6399313665488777`*^9}, {3.6399323124692636`*^9, 
   3.6399323215042763`*^9}, {3.639932362387344*^9, 3.6399323980913954`*^9}, {
   3.6399324362894497`*^9, 3.6399324822995176`*^9}, {3.639932725504877*^9, 
   3.639932775578949*^9}, {3.640688001420181*^9, 3.6406880247734222`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Create New Spin", "Subsection",
 CellChangeTimes->{{3.639293662886696*^9, 3.6392936685651054`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"CreateNew", "[", 
   RowBox[{"str_", ",", "spin_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "newposition", ",", "newforward", ",", "newbackward", ",", "newID"}], 
     "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"str", " ", "\[Equal]", " ", "\"\<forward\>\""}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"newposition", " ", "=", " ", 
        RowBox[{"Round", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"A", "[", "spin", "]"}], "[", "\"\<position\>\"", "]"}], 
          "+", 
          RowBox[{
           RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"", "]"}]}],
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"1", "<=", 
           RowBox[{"newposition", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "&&", 
          RowBox[{"1", "<=", 
           RowBox[{"newposition", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "\[LessEqual]", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "&&", 
          RowBox[{"1", "<=", 
           RowBox[{"newposition", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "\[LessEqual]", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"newID", " ", "=", " ", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Select", "[", 
              RowBox[{"A", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "[", "\"\<position\>\"", "]"}], "\[Equal]", 
                 "newposition"}], "&"}]}], "]"}], "]"}], "+", "1"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"A", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Append", "[", 
              RowBox[{"newposition", ",", "newID"}], "]"}], "\[Rule]", 
             RowBox[{"Association", "[", 
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"\"\<tensor\>\"", "\[Rule]", 
                 RowBox[{
                  RowBox[{"A", "[", 
                   RowBox[{"Append", "[", 
                    RowBox[{"newposition", ",", 
                    RowBox[{"newID", "-", "1"}]}], "]"}], "]"}], "[", 
                  "\"\<tensor\>\"", "]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"\"\<direction\>\"", "\[Rule]", 
                 RowBox[{
                  RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"", 
                  "]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{
                "\"\<position\>\"", " ", "\[Rule]", " ", "newposition"}], ",",
                 "\[IndentingNewLine]", 
                RowBox[{"\"\<neighbors\>\"", "\[Rule]", " ", 
                 RowBox[{
                  RowBox[{"A", "[", 
                   RowBox[{"Append", "[", 
                    RowBox[{"newposition", ",", 
                    RowBox[{"newID", "-", "1"}]}], "]"}], "]"}], "[", 
                  "\"\<neighbors\>\"", "]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"\"\<forward\>\"", "->", 
                 RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"\"\<backward\>\"", "\[Rule]", "spin"}]}], "}"}], 
              "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"newforward", "=", 
           RowBox[{"Append", "[", 
            RowBox[{"newposition", ",", "newID"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"A", "[", "spin", "]"}], "[", "\"\<forward\>\"", "]"}], 
           " ", "=", " ", "newforward"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"AppendTo", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"A", "[", "n", "]"}], "[", "\"\<neighbors\>\"", "]"}], 
              ",", "newforward"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", 
              RowBox[{
               RowBox[{"A", "[", "newforward", "]"}], "[", 
               "\"\<neighbors\>\"", "]"}]}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"SurfacePositions", ",", "newposition"}], "]"}], ",", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"Surface", ",", "newforward"}], "]"}]}], "]"}], ";"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{"Null", ";"}]}], "\[IndentingNewLine]", "]"}]}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", 
         "===", "===", "===", "===", "===", "===", "===", "==="}], "="}], 
       "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"newposition", " ", "=", " ", 
        RowBox[{"Round", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"A", "[", "spin", "]"}], "[", "\"\<position\>\"", "]"}], 
          "-", 
          RowBox[{
           RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"", "]"}]}],
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"1", "<=", 
           RowBox[{"newposition", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[LessEqual]", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "&&", 
          RowBox[{"1", "<=", 
           RowBox[{"newposition", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "\[LessEqual]", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "&&", 
          RowBox[{"1", "<=", 
           RowBox[{"newposition", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "\[LessEqual]", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"newID", " ", "=", " ", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Select", "[", 
              RowBox[{"A", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "[", "\"\<position\>\"", "]"}], "\[Equal]", 
                 "newposition"}], "&"}]}], "]"}], "]"}], "+", "1"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"A", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Append", "[", 
              RowBox[{"newposition", ",", "newID"}], "]"}], "\[Rule]", 
             RowBox[{"Association", "[", 
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"\"\<tensor\>\"", "\[Rule]", 
                 RowBox[{
                  RowBox[{"A", "[", 
                   RowBox[{"Append", "[", 
                    RowBox[{"newposition", ",", 
                    RowBox[{"newID", "-", "1"}]}], "]"}], "]"}], "[", 
                  "\"\<tensor\>\"", "]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"\"\<direction\>\"", "\[Rule]", 
                 RowBox[{
                  RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"", 
                  "]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{
                "\"\<position\>\"", " ", "\[Rule]", " ", "newposition"}], ",",
                 "\[IndentingNewLine]", 
                RowBox[{"\"\<neighbors\>\"", "\[Rule]", " ", 
                 RowBox[{
                  RowBox[{"A", "[", 
                   RowBox[{"Append", "[", 
                    RowBox[{"newposition", ",", 
                    RowBox[{"newID", "-", "1"}]}], "]"}], "]"}], "[", 
                  "\"\<neighbors\>\"", "]"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"\"\<forward\>\"", "\[Rule]", "spin"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"\"\<backward\>\"", "\[Rule]", 
                 RowBox[{"{", "}"}]}]}], "}"}], "]"}]}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"newbackward", "=", 
           RowBox[{"Append", "[", 
            RowBox[{"newposition", ",", "newID"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"A", "[", "spin", "]"}], "[", "\"\<backward\>\"", "]"}], 
           " ", "=", " ", "newbackward"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"AppendTo", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"A", "[", "n", "]"}], "[", "\"\<neighbors\>\"", "]"}], 
              ",", "newbackward"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", 
              RowBox[{
               RowBox[{"A", "[", "newbackward", "]"}], "[", 
               "\"\<neighbors\>\"", "]"}]}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"SurfacePositions", ",", "newposition"}], "]"}], ",", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"Surface", ",", "newbackward"}], "]"}]}], "]"}], ";"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{"Null", ";"}]}], "\[IndentingNewLine]", "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6386957126005545`*^9, 3.6386957814746757`*^9}, {
   3.638695840333579*^9, 3.6386958479619923`*^9}, {3.6386961872625885`*^9, 
   3.638696204765819*^9}, {3.6387011159049683`*^9, 3.6387011371366053`*^9}, {
   3.638701418472599*^9, 3.6387014905603256`*^9}, {3.6387015245371857`*^9, 
   3.6387017721408205`*^9}, {3.63870184596015*^9, 3.638701973802375*^9}, {
   3.638702140831868*^9, 3.6387021578982983`*^9}, {3.638702436405587*^9, 
   3.6387024509604125`*^9}, 3.6387025196785336`*^9, {3.6387025937786636`*^9, 
   3.6387026422011485`*^9}, {3.6387027280792994`*^9, 
   3.6387027407777214`*^9}, {3.638702771728176*^9, 3.638702817264656*^9}, {
   3.6387034470845623`*^9, 3.6387035086734705`*^9}, {3.638703540575526*^9, 
   3.6387036739089603`*^9}, {3.638703720350242*^9, 3.638703794606373*^9}, {
   3.638704033458392*^9, 3.6387040622404428`*^9}, {3.638704121645347*^9, 
   3.638704167135027*^9}, {3.6387042051522937`*^9, 3.638704246320766*^9}, {
   3.6387043622913694`*^9, 3.638704391557021*^9}, {3.638704632421444*^9, 
   3.6387047824157076`*^9}, {3.638770162031457*^9, 3.638770184913766*^9}, {
   3.638774223381753*^9, 3.638774267821295*^9}, {3.638774321163346*^9, 
   3.6387743834679093`*^9}, {3.638774581004208*^9, 3.638774715385894*^9}, 
   3.638776535207982*^9, 3.63877896100873*^9, {3.638779107565112*^9, 
   3.638779107731122*^9}, {3.6387792113860507`*^9, 3.6387792837991924`*^9}, {
   3.6387793297308197`*^9, 3.6387793771735334`*^9}, {3.63877962765086*^9, 
   3.638779743145466*^9}, {3.638779822550007*^9, 3.6387799402617397`*^9}, {
   3.638779970898492*^9, 3.638780112248577*^9}, {3.638780248087346*^9, 
   3.638780268799531*^9}, {3.6387803215745497`*^9, 3.638780394765736*^9}, {
   3.6387828787588124`*^9, 3.6387830197488766`*^9}, {3.638783097542326*^9, 
   3.638783101564556*^9}, {3.6387838563157253`*^9, 3.6387838761118574`*^9}, {
   3.63878416917662*^9, 3.638784182589387*^9}, {3.6387842208335743`*^9, 
   3.638784227105933*^9}, {3.638784283148139*^9, 3.6387843409254436`*^9}, {
   3.6387843716452007`*^9, 3.638784504928824*^9}, {3.638784546397196*^9, 
   3.6387845985831804`*^9}, {3.638784632193103*^9, 3.6387846664140606`*^9}, {
   3.6387857757105083`*^9, 3.638785863917554*^9}, {3.638785944001134*^9, 
   3.638785986679575*^9}, {3.638786750649272*^9, 3.638786763115985*^9}, {
   3.638787117826273*^9, 3.6387871296359487`*^9}, {3.6387871624218235`*^9, 
   3.6387871674641123`*^9}, {3.638787956393236*^9, 3.6387879577883162`*^9}, 
   3.6388503295852127`*^9, {3.6388697263991413`*^9, 3.63886982800212*^9}, 
   3.638869871276596*^9, {3.638870467041642*^9, 3.638870493156088*^9}, {
   3.6388705665074167`*^9, 3.6388705978166723`*^9}, {3.6392357838762455`*^9, 
   3.639235784875647*^9}, {3.6392361339020734`*^9, 3.6392361915585766`*^9}, {
   3.639236289413889*^9, 3.639236299402907*^9}, 3.639236382012854*^9, {
   3.6392366539117403`*^9, 3.639236662433356*^9}, {3.639236693149211*^9, 
   3.6392366982846193`*^9}, {3.6392371393960066`*^9, 
   3.6392372732421083`*^9}, {3.6392375979923506`*^9, 3.63923760296976*^9}, 
   3.6392377702335253`*^9, {3.6392378334728374`*^9, 3.639237843371256*^9}, {
   3.6392378887395363`*^9, 3.6392379235279984`*^9}, {3.639238278380495*^9, 
   3.6392383695754576`*^9}, 3.6392384250134115`*^9, {3.639238502966007*^9, 
   3.6392385332460613`*^9}, {3.6392399503732023`*^9, 
   3.6392399572774153`*^9}, {3.6392410555521765`*^9, 
   3.6392410758246126`*^9}, {3.6392411534637504`*^9, 
   3.6392411945224237`*^9}, {3.6392412499909225`*^9, 3.6392415261840153`*^9}, 
   3.6392419365453854`*^9, {3.6392423349408984`*^9, 3.6392423505041265`*^9}, {
   3.6392424742289476`*^9, 3.6392425384978623`*^9}, {3.6392425828219414`*^9, 
   3.639242584118744*^9}, {3.6392426752005057`*^9, 3.6392426756217065`*^9}, {
   3.6392434311647573`*^9, 3.6392434690728235`*^9}, {3.6392435043600855`*^9, 
   3.6392436055418634`*^9}, {3.639243644105131*^9, 3.639243653246747*^9}, {
   3.6392436875356073`*^9, 3.639243702558434*^9}, {3.6392437336648884`*^9, 
   3.6392438440038824`*^9}, {3.63924412171557*^9, 3.639244149655219*^9}, {
   3.6392442152689342`*^9, 3.639244249214594*^9}, {3.639244795327533*^9, 
   3.6392448564328403`*^9}, {3.639245471781581*^9, 3.639245482327199*^9}, {
   3.6392873543141117`*^9, 3.639287375483349*^9}, {3.6392874099282093`*^9, 
   3.639287439412261*^9}, {3.639287483685139*^9, 3.63928748978475*^9}, 
   3.639293685366335*^9, {3.6392954013625145`*^9, 3.639295402984917*^9}, {
   3.6393002043337*^9, 3.639300208124507*^9}, {3.6393002499637804`*^9, 
   3.639300267217411*^9}, {3.6393003300543213`*^9, 3.639300367509987*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Associate Spin", "Subsection",
 CellChangeTimes->{{3.6392936975499563`*^9, 3.6392937056307707`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Associate", "[", "spin_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"oldforward", ",", "oldbackward", ",", 
      RowBox[{"forwardneighbors", "=", 
       RowBox[{"{", "}"}]}], ",", "backwardneighbors", ",", 
      RowBox[{"minforward", "=", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"minbackward", "=", 
       RowBox[{"{", "}"}]}], ",", "E0", ",", "E1", ",", "Emin"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"A", "[", "spin", "]"}], "[", "\"\<forward\>\"", "]"}], " ", 
        "\[Equal]", " ", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"forwardneighbors", " ", "=", " ", 
         RowBox[{"F", "[", "spin", "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"forwardneighbors", " ", "\[Equal]", " ", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"CreateNew", "[", 
            RowBox[{"\"\<forward\>\"", ",", "spin"}], "]"}], ";"}], 
          "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Emin", " ", "=", 
            RowBox[{"10", "^", "10"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"E0", " ", "=", " ", 
               RowBox[{"Eint", "[", 
                RowBox[{"spin", ",", "newforward"}], "]"}]}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"E0", "<", "Emin"}], " ", "&&", " ", 
                 "\[IndentingNewLine]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"A", "[", "newforward", "]"}], "[", 
                    "\"\<direction\>\"", "]"}], ".", 
                    RowBox[{
                    RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"",
                     "]"}]}], ">", "0"}], " ", "&&", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"A", "[", "newforward", "]"}], "[", 
                    "\"\<backward\>\"", "]"}], "\[Equal]", 
                    RowBox[{"{", "}"}]}]}], ")"}], "||", 
                   "\[IndentingNewLine]", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"A", "[", "newforward", "]"}], "[", 
                    "\"\<direction\>\"", "]"}], ".", 
                    RowBox[{
                    RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"",
                     "]"}]}], "<", "0"}], " ", "&&", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"A", "[", "newforward", "]"}], "[", 
                    "\"\<forward\>\"", "]"}], " ", "\[Equal]", " ", 
                    RowBox[{"{", "}"}]}]}], ")"}]}], ")"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Emin", " ", "=", " ", "E0"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"minforward", " ", "=", " ", "newforward"}], ";"}]}],
                "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"newforward", ",", "forwardneighbors"}], "}"}]}], "]"}],
            ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"minforward", "==", 
              RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"CreateNew", "[", 
               RowBox[{"\"\<forward\>\"", ",", "spin"}], "]"}], ";"}], 
             "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"A", "[", "minforward", "]"}], "[", 
                  "\"\<direction\>\"", "]"}], ".", 
                 RowBox[{
                  RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"", 
                  "]"}]}], "<", "0"}], " ", ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Flip", "[", 
                 RowBox[{"minforward", ",", "\"\<forwards\>\""}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"A", "[", "spin", "]"}], "[", "\"\<forward\>\"", 
                  "]"}], " ", "=", " ", "minforward"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"A", "[", "minforward", "]"}], "[", 
                  "\"\<backward\>\"", "]"}], " ", "=", " ", "spin"}], ";"}], 
               "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"A", "[", "spin", "]"}], "[", "\"\<forward\>\"", 
                  "]"}], " ", "=", " ", "minforward"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"A", "[", "minforward", "]"}], "[", 
                  "\"\<backward\>\"", "]"}], " ", "=", " ", "spin"}], ";"}]}],
               "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
            "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
         "===", "==="}], "="}], "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"A", "[", "spin", "]"}], "[", "\"\<backward\>\"", "]"}], " ",
         "\[Equal]", " ", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"backwardneighbors", " ", "=", " ", 
         RowBox[{"B", "[", "spin", "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"backwardneighbors", " ", "\[Equal]", " ", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"CreateNew", "[", 
            RowBox[{"\"\<backward\>\"", ",", "spin"}], "]"}], ";"}], 
          "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Emin", " ", "=", 
            RowBox[{"10", "^", "10"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"E0", " ", "=", " ", 
               RowBox[{"Eint", "[", 
                RowBox[{"spin", ",", "newbackward"}], "]"}]}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"E0", "<", "Emin"}], " ", "&&", " ", 
                 "\[IndentingNewLine]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"A", "[", "newbackward", "]"}], "[", 
                    "\"\<direction\>\"", "]"}], ".", 
                    RowBox[{
                    RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"",
                     "]"}]}], ">", "0"}], " ", "&&", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"A", "[", "newbackward", "]"}], "[", 
                    "\"\<forward\>\"", "]"}], "\[Equal]", 
                    RowBox[{"{", "}"}]}]}], ")"}], "||", 
                   "\[IndentingNewLine]", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"A", "[", "newbackward", "]"}], "[", 
                    "\"\<direction\>\"", "]"}], ".", 
                    RowBox[{
                    RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"",
                     "]"}]}], "<", "0"}], " ", "&&", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"A", "[", "newbackward", "]"}], "[", 
                    "\"\<backward\>\"", "]"}], " ", "\[Equal]", " ", 
                    RowBox[{"{", "}"}]}]}], ")"}]}], ")"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Emin", " ", "=", " ", "E0"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"minbackward", " ", "=", " ", "newbackward"}], 
                 ";"}]}], "\[IndentingNewLine]", "]"}]}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"newbackward", ",", "backwardneighbors"}], "}"}]}], 
            "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"minbackward", "==", 
              RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"CreateNew", "[", 
               RowBox[{"\"\<backward\>\"", ",", "spin"}], "]"}], ";"}], 
             "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"A", "[", "minbackward", "]"}], "[", 
                  "\"\<direction\>\"", "]"}], ".", 
                 RowBox[{
                  RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"", 
                  "]"}]}], "<", "0"}], " ", ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Flip", "[", 
                 RowBox[{"minbackward", ",", "\"\<backwards\>\""}], "]"}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"A", "[", "spin", "]"}], "[", "\"\<backward\>\"", 
                  "]"}], " ", "=", " ", "minbackward"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"A", "[", "minbackward", "]"}], "[", 
                  "\"\<forward\>\"", "]"}], " ", "=", " ", "spin"}], ";"}], 
               "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"A", "[", "spin", "]"}], "[", "\"\<backward\>\"", 
                  "]"}], " ", "=", " ", "minbackward"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"A", "[", "minbackward", "]"}], "[", 
                  "\"\<forward\>\"", "]"}], " ", "=", " ", "spin"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
            "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6386957126005545`*^9, 3.6386957814746757`*^9}, {
   3.638695840333579*^9, 3.6386958479619923`*^9}, {3.6386961872625885`*^9, 
   3.638696204765819*^9}, {3.6387011159049683`*^9, 3.6387011371366053`*^9}, {
   3.638701418472599*^9, 3.6387014905603256`*^9}, {3.6387015245371857`*^9, 
   3.6387017721408205`*^9}, {3.63870184596015*^9, 3.638701973802375*^9}, {
   3.638702140831868*^9, 3.6387021578982983`*^9}, {3.638702436405587*^9, 
   3.6387024509604125`*^9}, 3.6387025196785336`*^9, {3.6387025937786636`*^9, 
   3.6387026422011485`*^9}, {3.6387027280792994`*^9, 
   3.6387027407777214`*^9}, {3.638702771728176*^9, 3.638702817264656*^9}, {
   3.6387034470845623`*^9, 3.6387035086734705`*^9}, {3.638703540575526*^9, 
   3.6387036739089603`*^9}, {3.638703720350242*^9, 3.638703794606373*^9}, {
   3.638704033458392*^9, 3.6387040622404428`*^9}, {3.638704121645347*^9, 
   3.638704167135027*^9}, {3.6387042051522937`*^9, 3.638704246320766*^9}, {
   3.6387043622913694`*^9, 3.638704391557021*^9}, {3.638704632421444*^9, 
   3.6387047824157076`*^9}, {3.638770162031457*^9, 3.638770184913766*^9}, {
   3.638774223381753*^9, 3.638774267821295*^9}, {3.638774321163346*^9, 
   3.6387743834679093`*^9}, {3.638774581004208*^9, 3.638774715385894*^9}, 
   3.638776535207982*^9, 3.63877896100873*^9, {3.638779107565112*^9, 
   3.638779107731122*^9}, {3.6387792113860507`*^9, 3.6387792837991924`*^9}, {
   3.6387793297308197`*^9, 3.6387793771735334`*^9}, {3.63877962765086*^9, 
   3.638779743145466*^9}, {3.638779822550007*^9, 3.6387799402617397`*^9}, {
   3.638779970898492*^9, 3.638780112248577*^9}, {3.638780248087346*^9, 
   3.638780268799531*^9}, {3.6387803215745497`*^9, 3.638780394765736*^9}, {
   3.6387828787588124`*^9, 3.6387830197488766`*^9}, {3.638783097542326*^9, 
   3.638783101564556*^9}, {3.6387838563157253`*^9, 3.6387838761118574`*^9}, {
   3.63878416917662*^9, 3.638784182589387*^9}, {3.6387842208335743`*^9, 
   3.638784227105933*^9}, {3.638784283148139*^9, 3.6387843409254436`*^9}, {
   3.6387843716452007`*^9, 3.638784504928824*^9}, {3.638784546397196*^9, 
   3.6387845985831804`*^9}, {3.638784632193103*^9, 3.6387846664140606`*^9}, {
   3.6387857757105083`*^9, 3.638785863917554*^9}, {3.638785944001134*^9, 
   3.638785986679575*^9}, {3.638786750649272*^9, 3.638786763115985*^9}, {
   3.638787117826273*^9, 3.6387871296359487`*^9}, {3.6387871624218235`*^9, 
   3.6387871674641123`*^9}, {3.638787956393236*^9, 3.6387879577883162`*^9}, 
   3.6388503295852127`*^9, {3.6388697263991413`*^9, 3.63886982800212*^9}, 
   3.638869871276596*^9, {3.638870467041642*^9, 3.638870493156088*^9}, {
   3.6388705665074167`*^9, 3.6388705978166723`*^9}, {3.6392357838762455`*^9, 
   3.639235784875647*^9}, {3.6392361339020734`*^9, 3.6392361915585766`*^9}, {
   3.639236289413889*^9, 3.639236299402907*^9}, 3.639236382012854*^9, {
   3.6392366539117403`*^9, 3.639236662433356*^9}, {3.639236693149211*^9, 
   3.6392366982846193`*^9}, {3.6392371393960066`*^9, 
   3.6392372732421083`*^9}, {3.6392375979923506`*^9, 3.63923760296976*^9}, 
   3.6392377702335253`*^9, {3.6392378334728374`*^9, 3.639237843371256*^9}, {
   3.6392378887395363`*^9, 3.6392379235279984`*^9}, {3.639238278380495*^9, 
   3.6392383695754576`*^9}, 3.6392384250134115`*^9, {3.639238502966007*^9, 
   3.6392385332460613`*^9}, {3.6392399503732023`*^9, 
   3.6392399572774153`*^9}, {3.6392410555521765`*^9, 
   3.6392410758246126`*^9}, {3.6392411534637504`*^9, 
   3.6392411945224237`*^9}, {3.6392412499909225`*^9, 3.6392415261840153`*^9}, 
   3.6392419365453854`*^9, {3.6392423349408984`*^9, 3.6392423505041265`*^9}, {
   3.6392424742289476`*^9, 3.6392425384978623`*^9}, {3.6392425828219414`*^9, 
   3.639242584118744*^9}, {3.6392426752005057`*^9, 3.6392426756217065`*^9}, {
   3.6392434311647573`*^9, 3.6392434690728235`*^9}, {3.6392435043600855`*^9, 
   3.6392436055418634`*^9}, {3.639243644105131*^9, 3.639243653246747*^9}, {
   3.6392436875356073`*^9, 3.639243702558434*^9}, {3.6392437336648884`*^9, 
   3.6392438440038824`*^9}, {3.63924412171557*^9, 3.639244149655219*^9}, {
   3.6392442152689342`*^9, 3.639244249214594*^9}, {3.639244795327533*^9, 
   3.6392448564328403`*^9}, {3.639245471781581*^9, 3.639245482327199*^9}, {
   3.6392873543141117`*^9, 3.639287375483349*^9}, {3.6392874099282093`*^9, 
   3.639287439412261*^9}, {3.639287483685139*^9, 3.63928748978475*^9}, 
   3.639293685366335*^9, {3.639295315733964*^9, 3.639295323128377*^9}, {
   3.6392953553112335`*^9, 3.6392953706460605`*^9}, {3.6392964505982866`*^9, 
   3.639296515712801*^9}, {3.6392965903433323`*^9, 3.639296615053776*^9}, {
   3.639932497651539*^9, 3.6399326269917264`*^9}, {3.6399328488350554`*^9, 
   3.639933063637415*^9}, {3.639933178781581*^9, 3.639933307378768*^9}, {
   3.6399333460218325`*^9, 3.6399334659800034`*^9}, {3.64068432641019*^9, 
   3.6406843555978413`*^9}, {3.6406857399910727`*^9, 
   3.6406857407866745`*^9}, {3.640686499157013*^9, 3.6406865306222687`*^9}, {
   3.640686621742028*^9, 3.640686682270135*^9}, {3.6406868939781065`*^9, 
   3.6406869205605536`*^9}, {3.6406872593151484`*^9, 
   3.6406872902188025`*^9}, {3.6406873254748645`*^9, 3.640687474548726*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Align Spin", "Subsection",
 CellChangeTimes->{{3.639293712900384*^9, 3.639293715380788*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Align", "[", "spin_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "newdirection", ",", "olddirection", ",", "E0", ",", "E1", ",", "p"}], 
     "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"olddirection", "=", 
      RowBox[{
       RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"", "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"newdirection", " ", "=", "  ", 
      RowBox[{"olddirection", " ", "+", " ", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "0.05"}], ",", "0.05"}], "}"}], ",", "3"}], "]"}]}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"newdirection", "=", 
      RowBox[{"newdirection", "/", 
       RowBox[{"Norm", "[", "newdirection", "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"E0", " ", "=", " ", 
      RowBox[{
       RowBox[{"Eint", "[", "spin", "]"}], " ", "+", " ", 
       RowBox[{"Edata", "[", "spin", "]"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"", "]"}], "=", 
      "newdirection"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"E1", " ", "=", " ", 
      RowBox[{
       RowBox[{"Eint", "[", "spin", "]"}], " ", "+", " ", 
       RowBox[{"Edata", "[", "spin", "]"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"p", " ", "=", " ", 
      RowBox[{"Min", "[", 
       RowBox[{"1.", ",", " ", 
        RowBox[{"Exp", "[", 
         RowBox[{"E0", "-", "E1"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"RandomReal", "[", "]"}], ">", "p"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"A", "[", "spin", "]"}], "[", "\"\<direction\>\"", "]"}], 
         "=", "olddirection"}], ";"}]}], "\[IndentingNewLine]", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6386957126005545`*^9, 3.6386957814746757`*^9}, {
   3.638695840333579*^9, 3.6386958479619923`*^9}, {3.6386961872625885`*^9, 
   3.638696204765819*^9}, {3.6387011159049683`*^9, 3.6387011371366053`*^9}, {
   3.638701418472599*^9, 3.6387014905603256`*^9}, {3.6387015245371857`*^9, 
   3.6387017721408205`*^9}, {3.63870184596015*^9, 3.638701973802375*^9}, {
   3.638702140831868*^9, 3.6387021578982983`*^9}, {3.638702436405587*^9, 
   3.6387024509604125`*^9}, 3.6387025196785336`*^9, {3.6387025937786636`*^9, 
   3.6387026422011485`*^9}, {3.6387027280792994`*^9, 
   3.6387027407777214`*^9}, {3.638702771728176*^9, 3.638702817264656*^9}, {
   3.6387034470845623`*^9, 3.6387035086734705`*^9}, {3.638703540575526*^9, 
   3.6387036739089603`*^9}, {3.638703720350242*^9, 3.638703794606373*^9}, {
   3.638704033458392*^9, 3.6387040622404428`*^9}, {3.638704121645347*^9, 
   3.638704167135027*^9}, {3.6387042051522937`*^9, 3.638704246320766*^9}, {
   3.6387043622913694`*^9, 3.638704391557021*^9}, {3.638704632421444*^9, 
   3.6387047824157076`*^9}, {3.638770162031457*^9, 3.638770184913766*^9}, {
   3.638774223381753*^9, 3.638774267821295*^9}, {3.638774321163346*^9, 
   3.6387743834679093`*^9}, {3.638774581004208*^9, 3.638774715385894*^9}, 
   3.638776535207982*^9, 3.63877896100873*^9, {3.638779107565112*^9, 
   3.638779107731122*^9}, {3.6387792113860507`*^9, 3.6387792837991924`*^9}, {
   3.6387793297308197`*^9, 3.6387793771735334`*^9}, {3.63877962765086*^9, 
   3.638779743145466*^9}, {3.638779822550007*^9, 3.6387799402617397`*^9}, {
   3.638779970898492*^9, 3.638780112248577*^9}, {3.638780248087346*^9, 
   3.638780268799531*^9}, {3.6387803215745497`*^9, 3.638780394765736*^9}, {
   3.6387828787588124`*^9, 3.6387830197488766`*^9}, {3.638783097542326*^9, 
   3.638783101564556*^9}, {3.6387838563157253`*^9, 3.6387838761118574`*^9}, {
   3.63878416917662*^9, 3.638784182589387*^9}, {3.6387842208335743`*^9, 
   3.638784227105933*^9}, {3.638784283148139*^9, 3.6387843409254436`*^9}, {
   3.6387843716452007`*^9, 3.638784504928824*^9}, {3.638784546397196*^9, 
   3.6387845985831804`*^9}, {3.638784632193103*^9, 3.6387846664140606`*^9}, {
   3.6387857757105083`*^9, 3.638785863917554*^9}, {3.638785944001134*^9, 
   3.638785986679575*^9}, {3.638786750649272*^9, 3.638786763115985*^9}, {
   3.638787117826273*^9, 3.6387871296359487`*^9}, {3.6387871624218235`*^9, 
   3.6387871674641123`*^9}, {3.638787956393236*^9, 3.6387879577883162`*^9}, 
   3.6388503295852127`*^9, {3.6388697263991413`*^9, 3.63886982800212*^9}, 
   3.638869871276596*^9, {3.638870467041642*^9, 3.638870493156088*^9}, {
   3.6388705665074167`*^9, 3.6388705978166723`*^9}, {3.6392357838762455`*^9, 
   3.639235784875647*^9}, {3.6392361339020734`*^9, 3.6392361915585766`*^9}, {
   3.639236289413889*^9, 3.639236299402907*^9}, 3.639236382012854*^9, {
   3.6392366539117403`*^9, 3.639236662433356*^9}, {3.639236693149211*^9, 
   3.6392366982846193`*^9}, {3.6392371393960066`*^9, 
   3.6392372732421083`*^9}, {3.6392375979923506`*^9, 3.63923760296976*^9}, 
   3.6392377702335253`*^9, {3.6392378334728374`*^9, 3.639237843371256*^9}, {
   3.6392378887395363`*^9, 3.6392379235279984`*^9}, {3.639238278380495*^9, 
   3.6392383695754576`*^9}, 3.6392384250134115`*^9, {3.639238502966007*^9, 
   3.6392385332460613`*^9}, {3.6392399503732023`*^9, 
   3.6392399572774153`*^9}, {3.6392410555521765`*^9, 
   3.6392410758246126`*^9}, {3.6392411534637504`*^9, 
   3.6392411945224237`*^9}, {3.6392412499909225`*^9, 3.6392415261840153`*^9}, 
   3.6392419365453854`*^9, {3.6392423349408984`*^9, 3.6392423505041265`*^9}, {
   3.6392424742289476`*^9, 3.6392425384978623`*^9}, {3.6392425828219414`*^9, 
   3.639242584118744*^9}, {3.6392426752005057`*^9, 3.6392426756217065`*^9}, {
   3.6392434311647573`*^9, 3.6392434690728235`*^9}, {3.6392435043600855`*^9, 
   3.6392436055418634`*^9}, {3.639243644105131*^9, 3.639243653246747*^9}, {
   3.6392436875356073`*^9, 3.639243702558434*^9}, {3.6392437336648884`*^9, 
   3.6392438440038824`*^9}, {3.63924412171557*^9, 3.639244149655219*^9}, {
   3.6392442152689342`*^9, 3.639244249214594*^9}, {3.639244795327533*^9, 
   3.6392448564328403`*^9}, {3.639245471781581*^9, 3.639245482327199*^9}, {
   3.6392873543141117`*^9, 3.639287375483349*^9}, {3.6392874099282093`*^9, 
   3.639287439412261*^9}, {3.639287483685139*^9, 3.63928748978475*^9}, 
   3.639293685366335*^9, {3.6392953793196754`*^9, 3.639295386402088*^9}, {
   3.640689111700536*^9, 3.6406891206881523`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Testing", "Subsection",
 CellChangeTimes->{{3.6392937224788003`*^9, 3.6392937236644025`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"EINT", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EDATA", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Initialize", "[", 
   RowBox[{"1.", ",", 
    RowBox[{"Pi", "/", "4."}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"i", ",", "j", ",", "k", ",", "n", ",", "s", ",", 
     RowBox[{"N", "=", "10"}]}], "}"}], ",", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"n", "=", "1"}], ",", 
      RowBox[{"n", "\[LessEqual]", "N"}], ",", 
      RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"EINT", " ", "=", " ", 
        RowBox[{"Append", "[", 
         RowBox[{"EINT", ",", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{"Eint", "[", 
               RowBox[{"{", 
                RowBox[{"i", ",", "j", ",", "k", ",", "s"}], "}"}], "]"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"s", ",", "1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"Select", "[", 
                  RowBox[{"A", ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", "\"\<position\>\"", "]"}], " ", 
                    "\[Equal]", " ", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "j", ",", "k"}], "}"}]}], "&"}]}], 
                  "]"}], "]"}]}], "}"}]}], " ", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"dim", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", 
              RowBox[{"dim", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", 
              RowBox[{"dim", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"EDATA", " ", "=", " ", 
        RowBox[{"Append", "[", 
         RowBox[{"EDATA", ",", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{"Edata", "[", 
               RowBox[{"{", 
                RowBox[{"i", ",", "j", ",", "k", ",", "s"}], "}"}], "]"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"s", ",", "1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"Select", "[", 
                  RowBox[{"A", ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", "\"\<position\>\"", "]"}], " ", 
                    "\[Equal]", " ", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "j", ",", "k"}], "}"}]}], "&"}]}], 
                  "]"}], "]"}]}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"dim", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", 
              RowBox[{"dim", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", 
              RowBox[{"dim", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "2"}], ",", 
          RowBox[{"i", "<", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "2"}], ",", 
            RowBox[{"j", "<", 
             RowBox[{"dim", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"k", "=", "2"}], ",", 
              RowBox[{"k", "<", 
               RowBox[{"dim", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], ",", 
              RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"s", "=", "1"}], ",", 
                RowBox[{"s", "\[LessEqual]", 
                 RowBox[{"Length", "[", 
                  RowBox[{"Select", "[", 
                   RowBox[{"A", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", "\"\<position\>\"", "]"}], " ", 
                    "\[Equal]", " ", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "j", ",", "k"}], "}"}]}], "&"}]}], 
                   "]"}], "]"}]}], ",", 
                RowBox[{"s", "++"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Associate", "[", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "j", ",", "k", ",", "s"}], "}"}], "]"}], 
                 ";"}]}], "\[IndentingNewLine]", "]"}]}], "]"}]}], "]"}]}], 
         "]"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "<=", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "<=", 
             RowBox[{"dim", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"k", "=", "1"}], ",", 
              RowBox[{"k", "<=", 
               RowBox[{"dim", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], ",", 
              RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"s", "=", "1"}], ",", 
                RowBox[{"s", "\[LessEqual]", 
                 RowBox[{"Length", "[", 
                  RowBox[{"Select", "[", 
                   RowBox[{"A", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", "\"\<position\>\"", "]"}], " ", 
                    "\[Equal]", " ", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "j", ",", "k"}], "}"}]}], "&"}]}], 
                   "]"}], "]"}]}], ",", 
                RowBox[{"s", "++"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Align", "[", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "j", ",", "k", ",", "s"}], "}"}], "]"}], 
                 ";"}]}], "\[IndentingNewLine]", "]"}]}], "]"}]}], "]"}]}], 
         "]"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"{", 
          RowBox[{"n", ",", 
           RowBox[{"Length", "[", "A", "]"}]}], "}"}], "]"}]}], ";"}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.6387265850926685`*^9, 3.6387266182545652`*^9}, {
   3.6387266547656536`*^9, 3.638726730015958*^9}, {3.638726767279089*^9, 
   3.6387268341269126`*^9}, {3.638728996310582*^9, 3.638728998703719*^9}, {
   3.638774777993475*^9, 3.638774796595539*^9}, 3.6387758845047636`*^9, {
   3.6387765618485055`*^9, 3.6387765648386765`*^9}, {3.6387766067520742`*^9, 
   3.6387766089281983`*^9}, {3.6387767545385265`*^9, 3.638776780083988*^9}, {
   3.638776871456214*^9, 3.6387768987137733`*^9}, {3.6387769612843523`*^9, 
   3.6387769751051426`*^9}, {3.6387770351615777`*^9, 
   3.6387770446761217`*^9}, {3.638780724314585*^9, 3.6387808244323115`*^9}, {
   3.6387808660246906`*^9, 3.6387808743601675`*^9}, {3.6387811093806095`*^9, 
   3.6387811422604904`*^9}, {3.6387813280711184`*^9, 
   3.6387814042754765`*^9}, {3.638781445752849*^9, 3.638781497681819*^9}, {
   3.638781740086684*^9, 3.6387818031062884`*^9}, {3.6387818667979317`*^9, 
   3.638781870587148*^9}, 3.6387820216447883`*^9, {3.638782085824459*^9, 
   3.638782089326659*^9}, {3.6387831847253127`*^9, 3.6387832302659173`*^9}, {
   3.638783265513933*^9, 3.6387833131676593`*^9}, 3.638783569945346*^9, {
   3.6387836932844005`*^9, 3.638783694868491*^9}, {3.6387861824447727`*^9, 
   3.6387861925063477`*^9}, {3.6387867726195283`*^9, 3.638786775172674*^9}, {
   3.6388464914933987`*^9, 3.6388465005414143`*^9}, {3.638846557481514*^9, 
   3.638846576731948*^9}, 3.6388468052063503`*^9, 3.638846942658191*^9, {
   3.6388470085215073`*^9, 3.638847011345112*^9}, {3.6388471927422304`*^9, 
   3.638847229917096*^9}, 3.638847460469901*^9, 3.638847581884914*^9, 
   3.638847694595112*^9, {3.6388477898800793`*^9, 3.638847806743709*^9}, 
   3.638847888222652*^9, {3.6388485203276405`*^9, 3.638848521560043*^9}, 
   3.638850034504409*^9, 3.638850213632795*^9, {3.6388699844391947`*^9, 
   3.638869997636818*^9}, 3.638870630311529*^9, 3.6388708769167624`*^9, {
   3.639234514585757*^9, 3.639234563757043*^9}, {3.639234947194609*^9, 
   3.639234955743424*^9}, {3.63923546768025*^9, 3.639235468023451*^9}, {
   3.6392360164170647`*^9, 3.639236016588665*^9}, 3.639238108190928*^9, 
   3.639238398623765*^9, {3.6392385528340964`*^9, 3.6392385590333076`*^9}, 
   3.6392399812938576`*^9, 3.6392439279164295`*^9, 3.6392439599744864`*^9, {
   3.6392448967901106`*^9, 3.6392449727211046`*^9}, {3.6392450773972883`*^9, 
   3.6392451264593744`*^9}, {3.6392453496645665`*^9, 
   3.6392453693830013`*^9}, {3.6392454954312224`*^9, 3.639245501796034*^9}, {
   3.6392461241918774`*^9, 3.6392461533090687`*^9}, 3.639246578231823*^9, {
   3.6392467757232943`*^9, 3.6392467809995112`*^9}, {3.639247011981043*^9, 
   3.639247019479375*^9}, 3.6392826488507195`*^9, {3.639287540406839*^9, 
   3.639287551202058*^9}, 3.639297488883731*^9, {3.6392978092146935`*^9, 
   3.6392978129899*^9}, {3.6393006519764867`*^9, 3.639300653286889*^9}, 
   3.6393031652374372`*^9, {3.6398434083738875`*^9, 3.6398434087238884`*^9}, {
   3.6406881287944045`*^9, 3.6406881289036045`*^9}, {3.6406891962696857`*^9, 
   3.6406892485673785`*^9}, {3.6406893428497458`*^9, 3.6406894145322723`*^9}, 
   3.640689761628792*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "796"}], "}"}]], "Print",
 CellChangeTimes->{3.6393031755022554`*^9, 3.639572196205881*^9, 
  3.639627447060774*^9, 3.6396310512350254`*^9, 3.63984318813456*^9, 
  3.6398433090057397`*^9, 3.6398434233439093`*^9, 3.6406880754579105`*^9, 
  3.6406881316648097`*^9, 3.640689146947998*^9, 3.6406892606302*^9, 
  3.6406894252670918`*^9, 3.6406897810070257`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "821"}], "}"}]], "Print",
 CellChangeTimes->{3.6393031755022554`*^9, 3.639572196205881*^9, 
  3.639627447060774*^9, 3.6396310512350254`*^9, 3.63984318813456*^9, 
  3.6398433090057397`*^9, 3.6398434233439093`*^9, 3.6406880754579105`*^9, 
  3.6406881316648097`*^9, 3.640689146947998*^9, 3.6406892606302*^9, 
  3.6406894252670918`*^9, 3.6406897842674313`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3", ",", "838"}], "}"}]], "Print",
 CellChangeTimes->{3.6393031755022554`*^9, 3.639572196205881*^9, 
  3.639627447060774*^9, 3.6396310512350254`*^9, 3.63984318813456*^9, 
  3.6398433090057397`*^9, 3.6398434233439093`*^9, 3.6406880754579105`*^9, 
  3.6406881316648097`*^9, 3.640689146947998*^9, 3.6406892606302*^9, 
  3.6406894252670918`*^9, 3.6406897876086397`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"4", ",", "849"}], "}"}]], "Print",
 CellChangeTimes->{3.6393031755022554`*^9, 3.639572196205881*^9, 
  3.639627447060774*^9, 3.6396310512350254`*^9, 3.63984318813456*^9, 
  3.6398433090057397`*^9, 3.6398434233439093`*^9, 3.6406880754579105`*^9, 
  3.6406881316648097`*^9, 3.640689146947998*^9, 3.6406892606302*^9, 
  3.6406894252670918`*^9, 3.6406897910250454`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"5", ",", "854"}], "}"}]], "Print",
 CellChangeTimes->{3.6393031755022554`*^9, 3.639572196205881*^9, 
  3.639627447060774*^9, 3.6396310512350254`*^9, 3.63984318813456*^9, 
  3.6398433090057397`*^9, 3.6398434233439093`*^9, 3.6406880754579105`*^9, 
  3.6406881316648097`*^9, 3.640689146947998*^9, 3.6406892606302*^9, 
  3.6406894252670918`*^9, 3.640689794503852*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"6", ",", "856"}], "}"}]], "Print",
 CellChangeTimes->{3.6393031755022554`*^9, 3.639572196205881*^9, 
  3.639627447060774*^9, 3.6396310512350254`*^9, 3.63984318813456*^9, 
  3.6398433090057397`*^9, 3.6398434233439093`*^9, 3.6406880754579105`*^9, 
  3.6406881316648097`*^9, 3.640689146947998*^9, 3.6406892606302*^9, 
  3.6406894252670918`*^9, 3.6406897979826574`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"7", ",", "856"}], "}"}]], "Print",
 CellChangeTimes->{3.6393031755022554`*^9, 3.639572196205881*^9, 
  3.639627447060774*^9, 3.6396310512350254`*^9, 3.63984318813456*^9, 
  3.6398433090057397`*^9, 3.6398434233439093`*^9, 3.6406880754579105`*^9, 
  3.6406881316648097`*^9, 3.640689146947998*^9, 3.6406892606302*^9, 
  3.6406894252670918`*^9, 3.6406898014458637`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"8", ",", "856"}], "}"}]], "Print",
 CellChangeTimes->{3.6393031755022554`*^9, 3.639572196205881*^9, 
  3.639627447060774*^9, 3.6396310512350254`*^9, 3.63984318813456*^9, 
  3.6398433090057397`*^9, 3.6398434233439093`*^9, 3.6406880754579105`*^9, 
  3.6406881316648097`*^9, 3.640689146947998*^9, 3.6406892606302*^9, 
  3.6406894252670918`*^9, 3.64068980490907*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"9", ",", "856"}], "}"}]], "Print",
 CellChangeTimes->{3.6393031755022554`*^9, 3.639572196205881*^9, 
  3.639627447060774*^9, 3.6396310512350254`*^9, 3.63984318813456*^9, 
  3.6398433090057397`*^9, 3.6398434233439093`*^9, 3.6406880754579105`*^9, 
  3.6406881316648097`*^9, 3.640689146947998*^9, 3.6406892606302*^9, 
  3.6406894252670918`*^9, 3.6406898083722763`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"10", ",", "856"}], "}"}]], "Print",
 CellChangeTimes->{3.6393031755022554`*^9, 3.639572196205881*^9, 
  3.639627447060774*^9, 3.6396310512350254`*^9, 3.63984318813456*^9, 
  3.6398433090057397`*^9, 3.6398434233439093`*^9, 3.6406880754579105`*^9, 
  3.6406881316648097`*^9, 3.640689146947998*^9, 3.6406892606302*^9, 
  3.6406894252670918`*^9, 3.640689811819882*^9}]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"EintDistr", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Eint", "[", 
          RowBox[{"{", 
           RowBox[{"i", ",", "j", ",", "k", ",", "s"}], "}"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "1", ",", 
           RowBox[{"Length", "[", 
            RowBox[{"Select", "[", 
             RowBox[{"A", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", "\"\<position\>\"", "]"}], " ", "\[Equal]", 
                " ", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "j", ",", "k"}], "}"}]}], "&"}]}], "]"}], 
            "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"dim", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"dim", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"dim", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}], ",", "3"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6392972694693456`*^9, 3.6392973666575165`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", "EintDistr", "]"}]], "Input",
 CellChangeTimes->{{3.6392973697931213`*^9, 3.6392973754559317`*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.008333333333333333], 
     AbsoluteThickness[1.6], PointBox[CompressedData["
1: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
5XdJOqo3x75ybkHjhjq8TKM8spLipzwds6/1Hipy4fk9Hd7WH9wyOtL5oiod
9j5VtnbutD816Xjda3+q9jzZ96XOP6tOWZ2Zwb9/k6P8XtKrfdEkz1yOtSFP
jkm0xK+WcuTPbuxtVkP+tZUjoFFc/xZfKb6EcnRe/8s7d6qO/C/HuZpRL9f3
o3wQybF++9XSU6tInoscu9ZUlHitJP9CjqhXS7zfXSL+cJUDc6KfnPhG/ZtY
jk3p3XU5d+l5Tzl6d2qeM7AR6SuRI+RTYNfPbykeA+Wwsqn8NI/jz5ty6JZZ
d2+7nPY3Xo5BLysNb9rw9VeOsObFMV3nEj+q5VBkrbpnqqT41cgb+jO7br2Q
0XZGkH1aOabeH1A2QU/1LF+OVc+ddm3qRfJ0coxvkxN+y4pwsRxdUraoNqmp
n9fLEXNf2De+KfFNiRxDVxyK77KT+mGDHKac5urGaZTf5Yw+RjlaWQVPFT6m
frNKDrvVm4aLWtL8GjneDzngduUx5fMXObI63dAp/Pj8V6DQLvpxd0vyt7kC
Cdei/4iuJH9bKnDPfYZEraP4tVXgSvfSlLfW9D5DqEDU3rMvt+yj/tdJgb5h
RZ63etN9hkjRUF8XBZKX3aiYFnmV/K/A4uIZeUuXUf/uqsCrvsn3X/P3U2IF
Llo/cth3muLdUwGT92Yn2w2g/ZMoUCuc65X4gp4PVKDRpJ9btm8gvpQqMOB+
B3ebmXS/GK9A9iXx+TdriU84BeaXrnU6tZziSc3oq1HgmO+2STHV1H9nK5Bx
/tty/xz+fZsCj/6I+dVEQfLz6+RNkJ6/15K/r1VgkvJWzq+3VK+KFehf+Pfa
dX/w74cU6HT6i9/TrhQ/JQq8W1ZQmKMkbFBg9Log+ZU2v9XPL1egeJnBaFZw
gvhfgcADZ+8F8/xbpcCtWL8LE5SUDzWMPV8YLFA2xOZKTAy0HmB1m/xpyYzb
MljIYCclciaGtp+6l+6jRcy4C4PBYFcGixnsqYT96FouoRf/PpYZD1Ri0F3H
h78doP2TKnF+Q9tZ6aJ8yn8l9p1tWzOtF9V7TonLwTO1L1MpHtVKNInRnnrQ
l/p/jRL9dxt2GH/R+TVbCcdhVgdHpFK8aJW4UXjk4fX1xK/5SixYkb5cLztA
/ldi5/CUFuX8fX2xEvtXf9rbeBl/fldiTJZQUhZ8jvyvhNjB79ahWspngxLl
shb2wweQPeWMvUYlxt2y2Dx8DPFdlRJ+jfafV/yg+lWjxO/Lt9TsvE3880WJ
c2/fGfpt5r/TVcF7XOMsqQ/1a+YqnO122t4unPoFSxU6T9xkvTuN4tlWBcto
5+N9GxE/C1WYdqN5N4eV9P2RkwqTBj4znh/Ovy9T4U+/Sq/z8+l84aJCrH25
c9EAqh9Q4bWz273Z/Wh/XFXQJ3nUurSk/BDXYYvkilfW1H97qtDn0gjBtTDK
Z4mK8b8KE0o17Xf0ov5IqsJpq1emIeD5X4XQLm1Pw5P6UU6FygSPcWXBlJ9q
FUzn32m9M5O/j1LhxpGnvmuriD+zVXgz97HHewH5Q6vCTmmPtTav+Pxn9NGp
0GXcjAFjSyieilVI+N1SNL6M5OlVUCjzZJ186f17iQqHQv/Zscy1WT021K0/
+v7ZS1+p/pWrUDq7f6du/PcHRhW+lxV1D3Hj818Fx8+xvZTbqZ7UqLB6i/zW
1fa0n18Y/QQZWCbd1vUy/72MeQZsZoSHxeuJbywzcPhwld2Kp/R+wTYDKt+K
W7VK0l+YAa+cQK8OUrLfKQMbRRM7e9rx70syIB3XvseDjmSPSwYWZKd2zlxL
9yvIQODXuH/Ht6Z4d83ACY9pOxzc+fNfRkN9PTPQ44fi9X4n0leSgbLxjTvt
mUPyAjPQ2bTlLskPii9p3fqjLb6UhVF9ic/Ah2eDRZ7m/Pe+GdAt1I51/0r7
o85An9mG7gX890yaDHRtvCN4iI76k+wMOJ7q2/wvi0Pk/wxMfPnr/oEfdvXy
8jNwNbHvg5Eaet+kY/QvzkCLp3fLZsXz9zcZyJHp9D18+PMf87yBweUMNjK4
isE1GRghj/DyC6R4/8KMC9QNsTmDLRlsq8axLoMkEm0e5T8z7qRG6LXczp/9
KD5Fanj59v1tfTTFv4sa7hv6ZRQcJgw19N0ff4QF1VdXNaJ7eK60T6b+Qcys
78lgiRrDypv9Pu8j3ccEMuNSNU752f1bsID8Hc+Mc2qkLe487UgLup9Rq/G2
ZJy12o++n9KoEZZ64NXeUpqfzczXMjifwToGFzNYr0Zuzmz3D73pe7ESNQ55
v4gd35e/z1Fj8sNL4X6/iN/L1fiRma9FEf89EbNeFYNrGPyFwYJMbE91Wir7
RPxtnokFHYWmgjCe/zMbPm/LYCGDnRgsYrALg8Fg10z06zbGotG/lH/iTDTv
stXq2zziW89M9Pl5Z8FMe3ofLclEgZXNgn23qR8KZNaTMjiewRyD1QzWZKL9
zsF+41PovJCdCbeLscOq3fnvnTJxbH/y8FZeVB/z6/bT4NlX05Hqj45Zr5jB
egaXMNjA4PJMpL7rGuRaSudRYyYiD1mHRJ6k/r0qEwsLTzjsukPnl5q6cbMr
3bZM4Ot/JvpvzlvT9M//UP+fBcHoHaHHk4gfzLMwp0A6//t9/nuArIbybRks
ZLATg0UMdslCTasTQf/9/xfIwpkfXk3uRtB52jULZk+qMpqsoftTcRY2WXoc
389Rfnhmoe1gx9nSbbnk/ywUCm6X9ckn+wKzsLmTum00/32wlJEfz2COwWoG
axiczWAtg/MZrMuC/818n/Aj1K8U/9/4/wA4SrXs
      "]]}, {}}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{},
  PlotRange->{{0., 855.}, {0, 4.482558766831508}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.639297375986333*^9, 3.6392976201735616`*^9, 
  3.6392978935328417`*^9, 3.6393007244074135`*^9, 3.6393032026619034`*^9, 
  3.6395722157879157`*^9, 3.639627466358008*^9, 3.6396311061315217`*^9, 
  3.6398432434226418`*^9, 3.639843369305832*^9, 3.6398434798209906`*^9, 
  3.640688080075519*^9, 3.64068817181928*^9, 3.640689175687249*^9, 
  3.640689456127946*^9, 3.6406898157992897`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"EdataDistr", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Edata", "[", 
          RowBox[{"{", 
           RowBox[{"i", ",", "j", ",", "k", ",", "s"}], "}"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"s", ",", "1", ",", 
           RowBox[{"Length", "[", 
            RowBox[{"Select", "[", 
             RowBox[{"A", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", "\"\<position\>\"", "]"}], " ", "\[Equal]", 
                " ", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "j", ",", "k"}], "}"}]}], "&"}]}], "]"}], 
            "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"dim", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"dim", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"dim", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}], ",", "3"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.639297389714357*^9, 3.6392973985283723`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"Sort", "[", "EdataDistr", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.639297406874387*^9, 3.639297423394816*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.011111111111111112`],
      AbsoluteThickness[1.6], PointBox[CompressedData["
1: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
JyKSsQ==
      "]]}, {}}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{},
  PlotRange->{{0., 855.}, {0, 1.2587003185480743`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.6392974079663887`*^9, 3.639297423878417*^9}, 
   3.6392976283479757`*^9, 3.6392978978384495`*^9, 3.6393007251406155`*^9, 
   3.63930320653071*^9, 3.639572216349517*^9, 3.639627466919609*^9, 
   3.639631119937546*^9, {3.6398432442926426`*^9, 3.6398432537446566`*^9}, 
   3.639843377205843*^9, 3.6398434842809963`*^9, 3.64068808077752*^9, 
   3.6406881724120812`*^9, 3.640689172237643*^9, 3.6406894580935497`*^9, 
   3.6406898196730967`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"EINT", ",", "EDATA"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6392977934430656`*^9, 3.6392977988406754`*^9}, {
  3.6392979060284634`*^9, 3.639297910162471*^9}, {3.640689267338212*^9, 
  3.640689272751421*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.019444444444444445`],
      AbsoluteThickness[1.6], 
     PointBox[{{1., 0.}, {2., 679.1236782860552}, {3., 714.2227535160329}, {
      4., 739.7535290865898}, {5., 751.3603233649251}, {6., 
      779.1144408253274}, {7., 784.8013667982751}, {8., 787.6264557737229}, {
      9., 795.1197574591542}, {10., 794.9752552600963}}]}, 
    {RGBColor[0.880722, 0.611041, 0.142051], PointSize[0.019444444444444445`],
      AbsoluteThickness[1.6], 
     PointBox[{{1., 524.6526996704549}, {2., 589.4768144374316}, {3., 
      613.3725111450223}, {4., 632.0525976672475}, {5., 645.6824134209511}, {
      6., 652.8092018880684}, {7., 656.2091386156274}, {8., 
      657.2327454993963}, {9., 658.0825414991781}, {10., 
      659.0720707001856}}]}, {}}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{},
  PlotRange->{{0., 10.}, {0, 795.1197574591542}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.6392977991526756`*^9, {3.6392979005372543`*^9, 3.6392979105524716`*^9}, 
   3.639300725171815*^9, 3.6393032089019136`*^9, 3.639572216380717*^9, 
   3.639627466950809*^9, 3.639631133322369*^9, {3.639843244312643*^9, 
   3.6398432547946587`*^9}, 3.6398433866738567`*^9, 3.6398434871610003`*^9, 
   3.6406880808243203`*^9, 3.640688172443281*^9, 3.6406891797140565`*^9, 
   3.640689279196233*^9, 3.640689459107551*^9, 3.6406898256635075`*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1261, 1382},
WindowMargins->{{Automatic, 504}, {Automatic, 8}},
FrontEndVersion->"10.0 for Microsoft Windows (64-bit) (December 4, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 2385, 59, 112, "Input"],
Cell[2968, 83, 680, 11, 31, "Output"]
}, Open  ]],
Cell[3663, 97, 4884, 116, 132, "Input"],
Cell[CellGroupData[{
Cell[8572, 217, 106, 1, 43, "Subsection"],
Cell[8681, 220, 10844, 244, 772, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19562, 469, 112, 1, 43, "Subsection"],
Cell[19677, 472, 4794, 105, 212, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24508, 582, 102, 1, 43, "Subsection"],
Cell[24613, 585, 2778, 69, 432, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27428, 659, 108, 1, 43, "Subsection"],
Cell[27539, 662, 11206, 257, 1012, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38782, 924, 105, 1, 43, "Subsection"],
Cell[38890, 927, 14748, 292, 1152, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[53675, 1224, 106, 1, 43, "Subsection"],
Cell[53784, 1227, 17130, 341, 1572, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[70951, 1573, 98, 1, 43, "Subsection"],
Cell[71052, 1576, 6679, 117, 392, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[77768, 1698, 99, 1, 43, "Subsection"],
Cell[CellGroupData[{
Cell[77892, 1703, 10685, 229, 612, "Input"],
Cell[CellGroupData[{
Cell[88602, 1936, 405, 7, 23, "Print"],
Cell[89010, 1945, 405, 7, 23, "Print"],
Cell[89418, 1954, 405, 7, 23, "Print"],
Cell[89826, 1963, 405, 7, 23, "Print"],
Cell[90234, 1972, 403, 7, 23, "Print"],
Cell[90640, 1981, 405, 7, 23, "Print"],
Cell[91048, 1990, 405, 7, 23, "Print"],
Cell[91456, 1999, 402, 7, 23, "Print"],
Cell[91861, 2008, 405, 7, 23, "Print"],
Cell[92269, 2017, 404, 7, 23, "Print"]
}, Open  ]]
}, Open  ]],
Cell[92700, 2028, 1329, 37, 52, "Input"],
Cell[CellGroupData[{
Cell[94054, 2069, 139, 2, 31, "Input"],
Cell[94196, 2073, 11403, 197, 249, "Output"]
}, Open  ]],
Cell[105614, 2273, 1329, 37, 52, "Input"],
Cell[CellGroupData[{
Cell[106968, 2314, 167, 3, 31, "Input"],
Cell[107138, 2319, 12225, 211, 243, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[119400, 2535, 350, 8, 31, "Input"],
Cell[119753, 2545, 1939, 41, 241, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
