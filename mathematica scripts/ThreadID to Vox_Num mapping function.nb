(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      8881,        239]
NotebookOptionsPosition[      8520,        222]
NotebookOutlinePosition[      8869,        237]
CellTagsIndexPosition[      8826,        234]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"f", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"c0_", ",", "c1_"}], "}"}], ",", "ThreadID_", ",", 
    "LatticeID_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "SliceOff", ",", "ColOff", ",", "RowOff", ",", "VoxsPerRow", ",", 
      "RowsPerSlice", ",", "VoxsPerSlice", ",", "VoxsToFill", ",", "VoxsLeft",
       ",", "LastRowLeft", ",", "sum"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SliceOff", " ", "=", " ", 
      RowBox[{"Quotient", "[", 
       RowBox[{"LatticeID", ",", "9"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ColOff", " ", "=", " ", 
      RowBox[{"Mod", "[", 
       RowBox[{"LatticeID", ",", "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"RowOff", " ", "=", " ", 
      RowBox[{"Mod", "[", 
       RowBox[{
        RowBox[{"Quotient", "[", 
         RowBox[{"LatticeID", ",", "3"}], "]"}], ",", "3"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"VoxsPerRow", " ", "=", " ", 
      RowBox[{
       RowBox[{"Quotient", "[", 
        RowBox[{
         RowBox[{"c0", "-", "ColOff", "-", "1"}], ",", "3"}], "]"}], " ", "+",
        "1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"RowsPerSlice", " ", "=", " ", 
      RowBox[{
       RowBox[{"Quotient", "[", 
        RowBox[{
         RowBox[{"c1", " ", "-", "RowOff", " ", "-", "1"}], ",", "3"}], "]"}],
        " ", "+", "1"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"VoxsPerSlice", " ", "=", 
      RowBox[{"VoxsPerRow", " ", "*", "RowsPerSlice"}]}], " ", ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"VoxsToFill", " ", "=", " ", 
      RowBox[{"ThreadID", "+", "1"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"VoxsLeft", " ", "=", " ", 
      RowBox[{"Mod", "[", 
       RowBox[{"VoxsToFill", ",", "VoxsPerSlice"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"LastRowLeft", " ", "=", " ", 
      RowBox[{"Mod", "[", 
       RowBox[{"VoxsLeft", ",", "VoxsPerRow"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
     "sum", " ", "=", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SliceOff", "*", "c0", "*", "c1"}], " ", "\[IndentingNewLine]",
        "+", 
       RowBox[{
        RowBox[{"Quotient", "[", 
         RowBox[{"VoxsToFill", ",", "VoxsPerSlice"}], "]"}], "*", "3", "*", 
        "c0", "*", "c1"}], "\[IndentingNewLine]", "+", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"VoxsPerSlice", "\[Equal]", "1"}], ",", "1", ",", "0"}], 
         "]"}], "*", 
        RowBox[{"(", 
         RowBox[{"ColOff", "+", "1", "-", 
          RowBox[{"3", "*", "c0", "*", "c1"}]}], ")"}]}], 
       "\[IndentingNewLine]", "+", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"VoxsToFill", "\[Equal]", "VoxsPerSlice"}], ",", "1", ",", 
          "0"}], "]"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"RowOff", "*", "c0"}], " ", "+", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"RowsPerSlice", "-", "1"}], ")"}], "*", "3", "*", "c0"}], 
          "  ", "+", "ColOff", " ", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"VoxsPerRow", "-", "1"}], ")"}], "*", "3"}], "  ", "-", 
          " ", 
          RowBox[{"3", "*", "c0", "*", "c1"}]}], ")"}]}], 
       "\[IndentingNewLine]", "-", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"VoxsLeft", "\[Equal]", "0"}], " ", "&&", " ", 
           RowBox[{"VoxsToFill", "!=", "VoxsPerSlice"}]}], ",", "1", ",", 
          "0"}], "]"}], "*", 
        RowBox[{"(", 
         RowBox[{"2", "*", "c0", "*", "c1"}], ")"}]}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "+", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"VoxsToFill", "!=", "VoxsPerSlice"}], ",", "1", ",", "0"}], 
         "]"}], "*", "\[IndentingNewLine]", 
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"RowOff", "*", "c0"}], "\[IndentingNewLine]", "+", 
          RowBox[{
           RowBox[{"Quotient", "[", 
            RowBox[{"VoxsLeft", ",", "VoxsPerRow"}], "]"}], "*", "3", "*", 
           "c0"}], "\[IndentingNewLine]", "-", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"VoxsLeft", "\[Equal]", "VoxsPerRow"}], " ", "||", " ", 
              RowBox[{"LastRowLeft", "\[Equal]", "0"}]}], ",", "1", ",", 
             "0"}], "]"}], "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "*", "c0"}], "+", 
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"c0", "-", "ColOff", "-", "1"}], ",", "3"}], "]"}], 
             "+", "1"}], ")"}]}], "\[IndentingNewLine]", "+", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"VoxsLeft", "!=", "VoxsPerRow"}], " ", "&&", " ", 
              RowBox[{"LastRowLeft", "!=", "0"}]}], ",", "1", ",", "0"}], 
            "]"}], "*", 
           RowBox[{"(", 
            RowBox[{"ColOff", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"LastRowLeft", "-", "1"}], ")"}], "*", "3"}]}], 
            ")"}]}]}], "\[IndentingNewLine]", ")"}]}]}]}], 
     "\[IndentingNewLine]", ";", "\[IndentingNewLine]", "sum"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6501066112488747`*^9, 3.650106611390275*^9}, 
   3.6501066595171614`*^9, {3.6501067382617025`*^9, 3.6501067413545084`*^9}, {
   3.6501069741685243`*^9, 3.650106997052165*^9}, {3.6501073081655207`*^9, 
   3.6501073587512107`*^9}, {3.6501073887534647`*^9, 3.650107395698477*^9}, {
   3.6501075232323046`*^9, 3.650107542042338*^9}, {3.650107629777095*^9, 
   3.650107635223504*^9}, {3.650108230127578*^9, 3.6501082602244315`*^9}, {
   3.650108329197955*^9, 3.650108381054248*^9}, {3.6501084284575324`*^9, 
   3.650108470533207*^9}, {3.650108773588349*^9, 3.6501087740875497`*^9}, {
   3.6501088048210044`*^9, 3.6501088117348166`*^9}, {3.6501088501640854`*^9, 
   3.650108885936349*^9}, {3.6501089755653176`*^9, 3.650108991440546*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"threadID", ",", 
     RowBox[{"f", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"7", ",", "7"}], "}"}], ",", "threadID", ",", "0"}], "]"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"threadID", ",", "0", ",", "10"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.6501072416100016`*^9, {3.6501076121984634`*^9, 3.650107614944068*^9}, {
   3.650107792542186*^9, 3.6501078113572197`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "21"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "24"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "27"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "42"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7", ",", "45"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "48"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"9", ",", "147"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"10", ",", "150"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6501072420312023`*^9, 3.650107336412571*^9, 3.6501073970732794`*^9, 
   3.6501075707281895`*^9, {3.650107615583669*^9, 3.6501076385961103`*^9}, {
   3.650107793010186*^9, 3.6501078119344206`*^9}, {3.650108247581409*^9, 
   3.6501082642054386`*^9}, 3.6501084099906993`*^9, 3.650108473127812*^9}]
}, Open  ]]
},
WindowSize->{1520, 773},
WindowMargins->{{251, Automatic}, {Automatic, -845}},
FrontEndVersion->"10.0 for Microsoft Windows (64-bit) (December 4, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 6398, 150, 692, "Input"],
Cell[CellGroupData[{
Cell[6981, 174, 488, 14, 31, "Input"],
Cell[7472, 190, 1032, 29, 31, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
